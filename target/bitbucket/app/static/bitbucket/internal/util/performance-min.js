define("bitbucket/internal/util/performance",["module","exports","jquery"],function(p,e,q){function n(f,a){function c(){d=null;l=!0;b.fire();b=new g.default.Callbacks;l=!1;a()}var b=new g.default.Callbacks,l=!1,d=null;return{name:f,forceExecute:function(){d&&(clearTimeout(d),c())},queue:function(a){l?a():(b.add(a),d||(d=setTimeout(c,0)))}}}Object.defineProperty(e,"__esModule",{value:!0});var g=babelHelpers.interopRequireDefault(q),m=n("READ",function(){h.forceExecute()}),h=n("WRITE",function(){m.forceExecute()});
e.default={queueDOMRead:m.queue.bind(m),queueDOMWrite:h.queue.bind(h),enqueueCapped:function(f,a,c){c=c||1;var b=0;return function(){b>=c||(b++,f(function(){try{return a.apply(this,arguments)}finally{b--}}))}},frameBatchedMap:function(f,a,c){a=g.default.extend({initial:500,min:10,max:Infinity},a);c=c||function(b){b()};return function(b){function l(){for(var a=Math.min(k+d,b.length);k<a;k++)h[k]=f(b[k])}var d=a.initial,e=g.default.Deferred(),k=0,h=[];requestAnimationFrame(function r(){if("pending"===
e.state()){var f=(new Date).getTime();c(l);var g=(new Date).getTime();d=Math.min(a.max,Math.max(a.min,Math.ceil(15/(g-f)*d)));k===b.length?e.resolve(h):requestAnimationFrame(r)}});return e}}};p.exports=e["default"]});