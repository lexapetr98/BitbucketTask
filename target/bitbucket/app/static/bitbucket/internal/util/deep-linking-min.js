define("bitbucket/internal/util/deep-linking",["module","exports","lodash","bitbucket/internal/util/function","bitbucket/internal/util/math"],function(h,e,k,l,m){function n(a,c,d,e){if(0===d)return a+c;var f=e[d-1];if(c!==f+1)return"-"===b.default.last(a)&&(a+=f),a+","+c;"-"!==b.default.last(a)&&(a+="-");d===e.length-1&&(a+=c);return a}Object.defineProperty(e,"__esModule",{value:!0});var b=babelHelpers.interopRequireDefault(k),f=babelHelpers.interopRequireDefault(l),g=babelHelpers.interopRequireDefault(m);
e.default={hashToLineNumbers:function(a){a=null!=a?a.replace(/[#\s]/g,""):"";return/^[0-9,\-]+$/.test(a)?b.default.chain(a).split(",").filter().flatMap(function(a){a=b.default.chain(a).split("-").map(f.default.unary(parseInt)).filter(f.default.not(isNaN)).map(g.default.highPass(1)).sortBy().value();return a.length?b.default.range(b.default.head(a),b.default.last(a)+1):[]}).uniq().sortBy().value():[]},lineNumbersToHash:function(a){return b.default.chain(a).uniq().filter(f.default.and(b.default.isNumber,
b.default.isFinite,g.default.isPositive)).sortBy().reduce(n,"").value()},updateSelectionRange:function(a,c){c=b.default.assign({existingLineNumbers:[],selectRange:!1,lastSelected:void 0},c);if(c.selectRange&&c.lastSelected){var d=b.default.range(Math.min(a,c.lastSelected),Math.max(a,c.lastSelected)+1);a=b.default.difference(d,c.existingLineNumbers).length?c.existingLineNumbers.concat(d):b.default.difference(c.existingLineNumbers,b.default.without(d,a))}else a=b.default.includes(c.existingLineNumbers,
a)?b.default.without(c.existingLineNumbers,a):c.existingLineNumbers.concat(a);return b.default.chain(a).uniq().sortBy().value()}};h.exports=e["default"]});