define("bitbucket/internal/util/html",["module","exports","@atlassian/aui","bitbucket/internal/util/function"],function(A,w,B,C){function p(){}function r(b,a,c){c=c||"string";return"function"===typeof b?b:x.default.constant(("undefined"===typeof b?"undefined":babelHelpers.typeof(b))===c?b:a)}function u(){this._backing=[]}Object.defineProperty(w,"__esModule",{value:!0});var z=babelHelpers.interopRequireDefault(B),x=babelHelpers.interopRequireDefault(C),v=window.console&&console.error?function(){console.error.apply(console,
arguments)}:z.default.log,n={OPEN:"open",CLOSE:"close"};p.prototype.next=function(){v("NodeStream.next is abstract and must be implemented")};p.prototype.getNextType=function(){v("NodeStream.getNextType is abstract and must be implemented")};p.prototype.getNextTextPosition=function(){v("NodeStream.getNextTextPosition is abstract and must be implemented")};var D=/<\s*(\w+)(?=\s|>)/;u.prototype.pushAtPriority=function(b,a){(this._backing[a]||(this._backing[a]=[])).push(b)};u.prototype.popAtPriority=
function(b){return(this._backing[b]||(this._backing[b]=[])).pop()};u.prototype.popPrioritiesAbove=function(b){var a=[],c=this._backing;for(b+=1;c.length>b;){var d=this._backing.pop();if(d)for(var e=d.length-1;0<=e;e--)a.push(d[e])}return a};u.prototype.peek=function(){for(var b=this._backing.length;b--;)if(this._backing[b]&&this._backing[b].length)return this._backing[b][this._backing[b].length-1]};var y=document.createElement("div");w.default={quickNDirtyAttach:function(b,a,c){if("html"!==c&&b.hasChildNodes()){y.innerHTML=
a;a=document.createDocumentFragment();for(var d=y.childNodes.length;d--;)a.appendChild(y.childNodes[0]);"append"===c?b.appendChild(a):b.insertBefore(a,b.firstChild)}else b.innerHTML=a},NodeStream:p,NodeType:n,htmlNodeStream:function(b,a){function c(){if(!k&&null!=d){k=!0;var a=b.indexOf("\x3c",d);a!==d&&(-1===a?e=d=null:(e+=l(b.substring(d,a)).length,d=a))}}var d=0,e=0,q=b.length,g,k,l=a||function(a){v("Not yet implemented")};a=new p;var h=[];a.getNextType=function(){var a;(a=g)||(c(),a=null==d?null:
"/"===b[d+1]?n.CLOSE:n.OPEN,a=g=a);return a};a.next=function(){c();if(null==d)return null;var a=this.getNextType(),f=b.indexOf("\x3e",d);f=-1===f?q:f+1;var m=b.substring(d,f),l={type:a,value:m,textPosition:e};a===n.OPEN&&(l.close={type:n.CLOSE,value:"\x3c/"+m.match(D)[1]+"\x3e"},h.push(e));d=f;g=null;k=!1;return l};a.getNextTextPosition=function(){c();return e};return a},lineNodeStream:function(b,a,c){c=c||{};var d=0,e=0,q=b.length,g=n.OPEN,k=r(c.lineStart,""),l=r(c.lineEnd,"\x3cbr /\x3e"),h=r(c.emptyLine,
""),t=r(c.lineOffset,1,"number"),f,m;a=a||x.default.dot("text");var E={open:function(){g=n.CLOSE;var c=a(b[d],d).length;m={type:n.CLOSE,value:c?l(b[d],d):h(b[d],d)+l(b[d],d)};f={type:n.OPEN,value:k(b[d],d),close:m,textPosition:e};e=e+c+t(b[d],d);return f},close:function(){d++;m.textPosition=e;g=n.OPEN;f=null;return m}};c=new p;c.getNextType=function(){return d>=q?null:g};c.next=function(){return d>=q?null:E[g]()};c.getNextTextPosition=function(){return d>=q?null:e};return c},mergeStreams:function(b){for(var a,
c,d=Array.prototype.slice.call(arguments,1),e=0,q=new u,g=[],k,l="";;){var h=void 0,t=d,f=Infinity;c={getNextTextPosition:x.default.constant(null)};var m=t.length;for(a=0;a<m;a++){var p=t[a],r=p.getNextTextPosition();null!=r&&r<f?(c=p,f=r,h=a):r===f&&p.getNextType()===n.CLOSE&&(c=p,h=a)}a=h;h=c;c=h.getNextTextPosition();f=(t=null==c)||c>e;if(g.length&&(f||a>=k)){for(k=g.length-1;0<=k;k--)m=g[k],l+=m.tag.value,q.pushAtPriority(m,m.streamIndex);g=[];k=null}f&&(l+=z.default.escapeHtml(b.substring(e,
c||void 0)));if(t)return l;e=h.next();if(null!=e){e.type===n.CLOSE?q.popAtPriority(a):q.pushAtPriority({streamIndex:a,tag:e},a);a=q.popPrioritiesAbove(a);if(a.length){k=a[0].streamIndex;t=a.length;for(h=0;h<t;h++)l+=a[h].tag.close.value;g.push.apply(g,a)}l+=e.value}e=c}},sanitizeId:function(b){return b.replace(/:/g,"\\:").replace(/\./g,"\\.")}};A.exports=w["default"]});