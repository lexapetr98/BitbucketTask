define("bitbucket/internal/util/synchronized-scroll","module exports lodash bitbucket/internal/model/direction bitbucket/internal/util/function bitbucket/internal/util/math bitbucket/internal/util/performance".split(" "),function(F,t,G,H,I,J,K){function k(a){if(a instanceof k)return a;if(!(this instanceof k))return new k(a);this._el=a;this._programmatic=!1;return this}function l(a,b){if(!(this instanceof l))return new l(a,b);this._el=b;this._parentScrollable=a;if(!this._parentScrollable._el)throw Error("Regions can't (yet) be created for custom Scrollables. We would need to solve the API problem of where to put a function to get the offset relative to the top of the scrollable.");
return this}function x(a,b){return b}function y(a,b){return a.scrollHeight-a.clientHeight-b}function z(a){return a.scrollHeight-a.clientHeight-a.scrollTop}function L(a,b,c,d,h,f){var A=b.scrollTop!==a.scrollTop,k=b.scrollLeft!==a.scrollLeft;c=e.default.filter(c,function(a){return A&&a.canScrollVertically||k&&a.canScrollHorizontally});if(!c.length)return[];if(!A)return e.default.map(c,function(a){return u(a,null,b.scrollLeft)});var q=b.scrollTop>a.scrollTop?m.default.DOWN:m.default.UP,r=c.concat(b),
p=e.default.filter(r,n.default.dot("canScrollVertically")),l=n.default.binary(Math.max);r=e.default.chain(p).map("topness").reduce(l,0).value()*(q===m.default.UP?1:0);p=e.default.chain(p).map("bottomness").reduce(l,0).value()*(q===m.default.UP?0:1);var g=M(r*r,p*p,q);p=g[1];r=g[2];d=0<g[0]?N(f,b,c,d,h):[];h=0<p?e.default.map(c,q===m.default.UP?B(a,b,C,x):D(a,b,C,x)):[];a=0<r?e.default.map(c,q===m.default.DOWN?B(a,b,z,y):D(a,b,z,y)):[];return e.default.chain(c).zip(e.default.zip(d,h,a)).map(n.default.spread(function(a,
c){var d=a.scrollLeft!==b.scrollLeft;if(!a.canScrollVertically)return u(a,null,d&&a.canScrollHorizontally?b.scrollLeft:null);c=c.map(n.default.defaultValue(0)).map(v.default.clamp(0,a.scrollHeight));c=e.default.chain(e.default.zip(c,g)).map(O).reduce(v.default.add,0).value();var f=0<(q===m.default.UP?-1:1)*(c-a.scrollTop);return f||d?u(a,f?c:null,d?b.scrollLeft:null):null})).filter(e.default.identity).value()}function M(a,b,c){var d=Math.max(a,b),h=Math.min(a,b),f=(1-d)*h/(1+h);a=a>b||a===b&&c===
m.default.UP;return[(1-d)/(1+h),a?d:f,a?f:d]}function u(a,b,c){return{scrollable:a.scrollable,scrollTop:b,scrollLeft:c}}function B(a,b,c,d){a=Math.max(c(a),1);var h=(a-c(b))/a;return function(a){var b=Math.max(c(a),1);b-=h*b;1>b&&(b=0);return d(a,b)}}function D(a,b,c,d){a=c(a);var h=c(b)-a;return function(a){var b=c(a)+h;return d(a,b)}}function N(a,b,c,d,h){var f=b.clientHeight*a;b=d(b.scrollable);var g=P(f,b);b=c.map(function(a){return a.canScrollVertically?E(h(g.region,a.scrollable)):null});var k=
Math.max(0,Math.min(1,(g.offsetTop+g.height-f)/g.height));return e.default.zip(b,c).map(n.default.spread(function(b,c){return c.canScrollVertically?Math.max(0,c.scrollTop+b.offsetTop-(k*b.height+c.clientHeight*a-b.height)):null}))}function P(a,b){var c;e.default.some(b,function(b){b=E(b);var d=b.offsetTop,e=b.height;return a>d&&a<=d+e?(c=b,!0):!1});return c}function E(a){return{region:a,offsetTop:a.getOffsetTop(),height:a.getHeight()}}function g(a){var b=a.getScrollInfo();b={scrollable:a,clientWidth:b.clientWidth,
clientHeight:b.clientHeight,scrollWidth:b.width,scrollHeight:b.height,scrollTop:b.top,scrollLeft:b.left,canScrollHorizontally:b.clientWidth<b.width,canScrollVertically:b.clientHeight<b.height};a=b.clientHeight/2;b.topness=a?Math.max(0,(a-b.scrollTop)/a):0;b.bottomness=a?Math.max(0,1-(b.scrollHeight-(b.scrollTop+b.clientHeight))/a):0;return b}function w(a){a=e.default.assign({},w.defaults,a);var b=g(a.self),c,d=Q.default.enqueueCapped(requestAnimationFrame,function(){var d=g(a.self),f=e.default.map(a.others,
g);f=L(c,d,f,a.getRegions,a.getLinkedRegion,a.focusHeightFraction);b=d;f.length&&a.executeCommands(f)});return{handle:function(){a.self.getAndUnsetProgrammaticScrollMarker()?b=g(a.self):(c=b,d())},reset:function(){b=g(a.self)}}}Object.defineProperty(t,"__esModule",{value:!0});var e=babelHelpers.interopRequireDefault(G),m=babelHelpers.interopRequireDefault(H),n=babelHelpers.interopRequireDefault(I),v=babelHelpers.interopRequireDefault(J),Q=babelHelpers.interopRequireDefault(K),O=n.default.spread(v.default.multiply);
k.prototype.getScrollInfo=function(){return{top:this._el.scrollTop,left:this._el.scrollLeft,width:this._el.scrollWidth,height:this._el.scrollHeight,clientWidth:this._el.clientWidth,clientHeight:this._el.clientHeight}};k.prototype.scrollTo=function(a,b){null!=b&&(this._programmatic=!0,this._el.scrollTop=b);null!=a&&(this._programmatic=!0,this._el.scrollLeft=a)};k.prototype.getAndUnsetProgrammaticScrollMarker=function(){var a=this._programmatic;this._programmatic=!1;return a};l.prototype.getHeight=
function(){return this._el.offsetHeight};l.prototype.getOffsetTop=function(){return this._el.getBoundingClientRect().top-this._parentScrollable._el.getBoundingClientRect().top};var C=n.default.dot("scrollTop");w.defaults={self:null,others:null,getRegions:null,getLinkedRegion:null,focusHeightFraction:.5,executeCommands:function(a){e.default.forEach(a,function(a){a.scrollable.scrollTo(a.scrollLeft,a.scrollTop)})}};t.default={getScrollHandler:w,createScrollable:k,createRegion:l};F.exports=t["default"]});