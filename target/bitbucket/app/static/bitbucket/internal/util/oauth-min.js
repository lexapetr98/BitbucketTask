define("bitbucket/internal/util/oauth",["module","exports","jquery","bitbucket/internal/util/events"],function(k,d,l,m){function n(a){var c=new f.default.Deferred,b={url:a,deferred:c,api:c.promise({abort:function(){g.cancelRequest(a)}})};e.default.trigger("bitbucket.internal.util.oauth.authorizationRequested",null,a);c.then(function(){e.default.trigger("bitbucket.internal.util.oauth.authorizationSucceeded",null,a)},function(){e.default.trigger("bitbucket.internal.util.oauth.authorizationFailed",null,
a)});g.fireRequest(a,c.resolve,c.reject);return b}function h(a){if(b){if(b.url===a)return b.api;b.api.abort()}a=b=n(a);b.deferred.always(function(){b=null});return a.api}Object.defineProperty(d,"__esModule",{value:!0});var f=babelHelpers.interopRequireDefault(l),e=babelHelpers.interopRequireDefault(m),g=function(){function a(){window.aouthWindow&&window.aouthWindow.close&&window.aouthWindow.close();window.oauthCallback=null;window.aouthWindow=null}return{fireRequest:function(c,b,d){window.oauthCallback=
{uri:c,success:function(){a();b&&b()},failure:function(){a();d&&d()}};window.aouthWindow=window.open(c)},cancelRequest:function(a){window.oauthCallback&&window.oauthCallback.uri===a&&window.oauthCallback.failure()}}}(),b;d.default={authorizeUrl:h,interceptLinks:function(a){(0,f.default)(document).on("click",a,function(a){var b=this.getAttribute("href");b&&(h(b),a.preventDefault())})}};k.exports=d["default"]});