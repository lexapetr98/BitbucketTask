define("bitbucket/internal/bbui/pull-request-header/components/merge","module exports jquery lodash prop-types react react-dom bitbucket/internal/enums ../../aui-react/inline-dialog ./merge-button ./merge-help-dialog".split(" "),function(m,l,d,n,p,h,q,r,t,u,v){Object.defineProperty(l,"__esModule",{value:!0});var f=babelHelpers.interopRequireDefault(d),w=babelHelpers.interopRequireDefault(n);d=babelHelpers.interopRequireDefault(p);var e=babelHelpers.interopRequireDefault(h),x=babelHelpers.interopRequireDefault(t),
y=babelHelpers.interopRequireDefault(u),z=babelHelpers.interopRequireDefault(v);h=function(d){function g(){var a,b,c,e;babelHelpers.classCallCheck(this,g);for(var d=arguments.length,f=Array(d),k=0;k<d;k++)f[k]=arguments[k];return e=(b=(c=babelHelpers.possibleConstructorReturn(this,(a=g.__proto__||Object.getPrototypeOf(g)).call.apply(a,[this].concat(f))),c),c.state={mergeHelpDialogShowing:!1},b),babelHelpers.possibleConstructorReturn(c,e)}babelHelpers.inherits(g,d);babelHelpers.createClass(g,[{key:"componentDidMount",
value:function(){var a=this;this.mergeWarningDialog=document.getElementById("merge-warning-inline-dialog");this.throttledWarningDialogHide=w.default.throttle(function(){a.mergeWarningDialog&&(a.mergeWarningDialog.open=!1)},50);(0,f.default)(window).on("scroll resize",this.throttledWarningDialogHide);this.onToggleMergeWarningDialog=function(b){a.setState({mergeWarningDialogOpen:"aui-show"===b.type?!0:!1})};(0,f.default)(this.mergeWarningDialog).on("aui-show aui-hide",this.onToggleMergeWarningDialog)}},
{key:"componentWillUnmount",value:function(){(0,f.default)(window).off("scroll resize",this.throttledWarningDialogHide);(0,f.default)(this.mergeWarningDialog).off("aui-show aui-hide",this.onToggleMergeWarningDialog)}},{key:"onHideMergeHelpDialog",value:function(){this.extendedMergeHelpContent="";this.setState({mergeHelpDialogShowing:!1});if(this.props.onMergeHelpDialogClose)this.props.onMergeHelpDialogClose()}},{key:"onMergeWarningClick",value:function(){this.toggleMergeWarningDialog()}},{key:"toggleMergeWarningDialog",
value:function(a){null==a&&(a=!this.mergeWarningDialog.open);var b=(0,f.default)(this.mergeWarningDialog),c=b.find(".merge-warning-content .aui-list-truncate");c.css({"max-height":0});this.mergeWarningDialog.open=a;a=(0,f.default)(window).height()-b.offset().top-b.outerHeight()-10;c.css({"max-height":Math.min(300,a)})}},{key:"showExtendedMergeHelp",value:function(){this.setState({mergeHelpDialogShowing:!0})}},{key:"render",value:function(){var a=this,b=this.props.pullRequest;if(b.state===r.PullRequestState.OPEN&&
b.mergeable){var c=[].concat(b.mergeable.vetoes||[]);b.mergeable.conflicted&&c.unshift({detailedMessage:AJS.I18n.getText("bitbucket.component.pull.request.merge.conflict.tooltip"),summaryMessage:AJS.I18n.getText("bitbucket.component.pull.request.merge.conflict.detail"),isConflictVeto:!0});this.props.conditions.canMerge||c.push({detailedMessage:AJS.I18n.getText("bitbucket.component.pull.request.merge.permissions.detail")});var d=void 0;this.state.mergeHelpDialogShowing&&(d=e.default.createElement(z.default,
{id:"extended-merge-help-dialog",onHide:function(){return a.onHideMergeHelpDialog()},pullRequest:b,stability:this.props.mergeHelp&&this.props.mergeHelp.stability,isAutoMergeConflict:this.props.mergeHelp&&this.props.mergeHelp.isAutoMergeConflict}));c=e.default.createElement(x.default,{key:"merge-warning-dialog",id:"merge-warning-inline-dialog",alignment:"bottom",onShow:function(a){(a=a.target.querySelectorAll("a, button").item(0))&&a.focus()},onHide:function(){(0,q.findDOMNode)(a).focus()}},e.default.createElement("div",
{className:"merge-warning-content"},e.default.createElement("h6",null,AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.title")),e.default.createElement("p",null,AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.info",c&&c.length)),e.default.createElement("ul",{className:"aui-list-truncate"},c&&c.map(function(b,c){var d=b.isConflictVeto?e.default.createElement("button",{className:"aui-button aui-button-link more-info",onClick:function(){return a.showExtendedMergeHelp()}},
AJS.I18n.getText("bitbucket.component.pull.request.merge.warnings.more.button")):null;return e.default.createElement("li",{key:"merge-issue-"+c},e.default.createElement("span",{className:"message"},e.default.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-warning"}),b.detailedMessage),d)}))));return e.default.createElement(e.default.Fragment,null,e.default.createElement(y.default,{onMergeClick:this.props.onMergeClick,onMergeWarningClick:function(){return a.onMergeWarningClick()},
mergeable:b.mergeable,conditions:this.props.conditions,conflicted:b.mergeable.conflicted,vetoes:b.mergeable.vetoes,extraButtonProps:{"aria-controls":"merge-warning-inline-dialog","aria-haspopup":!0},tooltipVisibility:!this.state.mergeWarningDialogOpen}),c,d)}return null}}],[{key:"getDerivedStateFromProps",value:function(a,b){a=a.showMergeHelpDialog;var c=b.mergeHelpDialogShowing;return{propShowMergeHelpDialog:a,mergeHelpDialogShowing:a===b.propShowMergeHelpDialog?c:a}}}]);return g}(h.Component);h.propTypes=
{conditions:d.default.object.isRequired,mergeHelp:d.default.object,onMergeClick:d.default.func.isRequired,onMergeHelpDialogClose:d.default.func,pullRequest:d.default.object.isRequired,showMergeHelpDialog:d.default.bool};l.default=h;m.exports=l["default"]});