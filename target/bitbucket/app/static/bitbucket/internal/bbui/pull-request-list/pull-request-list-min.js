define("bitbucket/internal/bbui/pull-request-list/pull-request-list","module exports @atlassian/aui jquery lodash prop-types react bitbucket/internal/enums bitbucket/internal/impl/urls bitbucket/internal/widget/icons/icons ../aui-react/avatar ../filter-bar/filter-bar ../pull-request-list-table/pull-request-list-table ./dom-event".split(" "),function(u,h,k,v,m,w,n,x,y,z,A,f,B,C){function p(a,b){return c.default.createElement(A.UserAvatar,{person:b,size:"selection"===a?"xsmall":"small",withName:!0,
withEmail:"result"===a,className:"pull-request-list-filter filter-"+a})}function q(b,d){return c.default.createElement("span",{className:"pull-request-list-filter filter-"+b},c.default.createElement(z.BranchIcon,null,a.default.I18n.getText("bitbucket.component.pull.request.list.branch")),c.default.createElement("span",{className:"name",title:d.displayId},d.displayId))}Object.defineProperty(h,"__esModule",{value:!0});var a=babelHelpers.interopRequireDefault(k),D=babelHelpers.interopRequireDefault(v),
g=babelHelpers.interopRequireDefault(m),b=babelHelpers.interopRequireDefault(w),c=babelHelpers.interopRequireDefault(n),l=babelHelpers.interopRequireDefault(x),e=babelHelpers.interopRequireDefault(y),E=babelHelpers.interopRequireDefault(f),F=babelHelpers.interopRequireDefault(B),G=babelHelpers.interopRequireDefault(C),r=function(b){return c.default.createElement("div",{className:"pull-request-intro"},c.default.createElement("div",{className:"intro-image"}),c.default.createElement("div",{className:"intro-text"},
c.default.createElement("h3",null,a.default.I18n.getText("bitbucket.component.pull.request.list.intro.title")),c.default.createElement("p",null,a.default.I18n.getText("bitbucket.component.pull.request.list.intro.description"))),c.default.createElement("div",{className:"intro-buttons"},c.default.createElement("a",{id:"empty-list-create-pr-button",className:"aui-button aui-button-primary",href:e.default.createPullRequest(b.repository)},a.default.I18n.getText("bitbucket.component.pull.request.list.intro.button.create")),
c.default.createElement("a",{id:"empty-list-help-button",className:"aui-button aui-button-link help-button",target:"_blank",href:e.default.help("help.pull.request")},a.default.I18n.getText("bitbucket.component.pull.request.list.intro.button.help"))))};r.propTypes={repository:b.default.object};var t=function(b){return c.default.createElement("div",{className:"empty-banner-content"},c.default.createElement("h3",null,b.filtered?a.default.I18n.getText("bitbucket.component.pull.request.filtered.no.matches"):
a.default.I18n.getText("bitbucket.component.pull.request.none")),c.default.createElement("p",{dangerouslySetInnerHTML:{__html:b.filtered?a.default.I18n.getText("bitbucket.component.pull.request.filtered.no.matches.description",'\x3ca id\x3d"reset-filters" href\x3d"'+e.default.allPullRequests(b.repository,"ALL")+'"\x3e',"\x3c/a\x3e"):a.default.I18n.getText("bitbucket.component.pull.request.none.description",'\x3ca href\x3d"'+e.default.createPullRequest(b.repository)+'"\x3e',"\x3c/a\x3e")},onClick:function(a){(0,
D.default)(a.target).closest("#reset-filters").length&&(0,G.default)(a)&&(b.onResetFilters(),a.preventDefault())},role:"presentation"}))};t.propTypes={filtered:b.default.bool.isRequired,repository:b.default.object,onResetFilters:b.default.func};k=function(e){function d(b){babelHelpers.classCallCheck(this,d);var a=babelHelpers.possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,b));a.onFilterChange=a.onFilterChange.bind(a);a.onResetFilters=a.onResetFilters.bind(a);var c=
b.initialFilter.state.value;b=!!(c&&"ALL"!==c||(0,m.chain)(b.initialFilter).pick(["author","target_ref","reviewer_self"]).some(function(a){return a.value}).value());a.state={isFiltered:b,stateFilter:c};return a}babelHelpers.inherits(d,e);babelHelpers.createClass(d,null,[{key:"propTypes",get:function(){var a=["id","label"];return{allFetched:b.default.bool.isRequired,currentUser:b.default.any,initialFilter:b.default.shape({state:b.default.shape(g.default.omit(f.Select.propTypes,a)).isRequired,author:b.default.shape(g.default.omit(f.AsyncSelect.propTypes,
a)).isRequired,target_ref:b.default.shape(g.default.omit(f.AsyncSelect.propTypes,a)).isRequired,reviewer_self:b.default.shape(g.default.omit(f.Toggle.propTypes,a)).isRequired}),focusedIndex:b.default.number,gettingStarted:b.default.bool,loading:b.default.bool.isRequired,openPullRequestCallback:b.default.func,onFilterChange:b.default.func.isRequired,onMorePrsRequested:b.default.func.isRequired,pullRequests:b.default.array.isRequired,repository:b.default.any.isRequired,selectedAuthor:b.default.any,
selectedTargetBranch:b.default.any}}}]);babelHelpers.createClass(d,[{key:"componentDidMount",value:function(){if(!this.props.pullRequests.length&&!this.props.allFetched)this.props.onMorePrsRequested()}},{key:"onFilterChange",value:function(a){var b=this,c={state:a["pr-state-filter"],author_id:a["pr-author-filter"]||null,target_ref_id:a["pr-target-branch-filter"]||null,reviewer_self:a["pr-reviewer-self-filter"]};this.setState({isFiltered:"ALL"!==c.state||!!c.author_id||!!c.target_ref_id||!!c.reviewer_self,
stateFilter:c.state},function(){return b.props.onFilterChange(c)})}},{key:"onResetFilters",value:function(){this._filterBar.set({"pr-author-filter":null,"pr-state-filter":"ALL","pr-target-branch-filter":null,"pr-reviewer-self-filter":!1})}},{key:"render",value:function(){var b=this,d=!this.props.loading&&0===this.props.pullRequests.length,e=[];d&&this.props.gettingStarted?e.push(c.default.createElement(r,{key:"getting-started",repository:this.props.repository})):(e.push(c.default.createElement(E.default,
{key:"filter-bar",onChange:this.onFilterChange,ref:function(a){return b._filterBar=a}},c.default.createElement(f.Select,babelHelpers.extends({},this.props.initialFilter.state,{id:"pr-state-filter",label:a.default.I18n.getText("bitbucket.component.pull.request.list.state"),menu:{items:[{id:l.default.PullRequestState.OPEN,text:a.default.I18n.getText("bitbucket.component.pull.request.list.state.open")},{id:l.default.PullRequestState.MERGED,text:a.default.I18n.getText("bitbucket.component.pull.request.list.state.merged")},
{id:l.default.PullRequestState.DECLINED,text:a.default.I18n.getText("bitbucket.component.pull.request.list.state.declined")},{id:"ALL",text:a.default.I18n.getText("bitbucket.component.pull.request.list.state.all")}]}})),c.default.createElement(f.AsyncSelect,babelHelpers.extends({},this.props.initialFilter.author,{id:"pr-author-filter",label:a.default.I18n.getText("bitbucket.component.pull.request.list.author"),searchPlaceholder:a.default.I18n.getText("bitbucket.component.pull.request.list.search.author"),
menu:{id:function(a){return a.name},initSelection:function(a,c){a=a.val();if(b.props.initialFilter.author.value===a)return c(b.props.selectedAuthor);throw Error("Unexpected value '"+a+"' when initializing the author filter.");},formatSelection:p.bind(null,"selection"),formatResult:p.bind(null,"result"),formatNoMatches:function(){return a.default.I18n.getText("bitbucket.component.pull.request.list.search.author.nomatches")},placeholder:a.default.I18n.getText("bitbucket.component.pull.request.list.author"),
dropdownCssClass:"pr-author-dropdown"}})),c.default.createElement(f.AsyncSelect,babelHelpers.extends({},this.props.initialFilter.target_ref,{id:"pr-target-branch-filter",label:a.default.I18n.getText("bitbucket.component.pull.request.list.branch.target"),searchPlaceholder:a.default.I18n.getText("bitbucket.component.pull.request.list.search.branch"),menu:{initSelection:function(a,c){a=a.val();if(b.props.initialFilter.target_ref.value===a)return c(b.props.selectedTargetBranch);throw Error("Unexpected value '"+
a+"' when initializing the target branch filter.");},formatSelection:q.bind(null,"selection"),formatResult:q.bind(null,"result"),formatNoMatches:function(){return a.default.I18n.getText("bitbucket.component.pull.request.list.search.branch.nomatches")},placeholder:a.default.I18n.getText("bitbucket.component.pull.request.list.branch.target"),dropdownCssClass:"pr-target-branch-dropdown"}})),this.props.currentUser&&c.default.createElement(f.Toggle,babelHelpers.extends({},this.props.initialFilter.reviewer_self,
{id:"pr-reviewer-self-filter",label:a.default.I18n.getText("bitbucket.component.pull.request.list.reviewer.self")})))),e.push(d?c.default.createElement(t,{key:"no-results",filtered:this.state.isFiltered,onResetFilters:this.onResetFilters,repository:this.props.repository}):c.default.createElement(F.default,{key:"table",focusedIndex:this.props.focusedIndex,pullRequests:this.props.pullRequests,allFetched:this.props.allFetched,onMoreItemsRequested:this.props.onMorePrsRequested,openCallback:this.props.openPullRequestCallback,
loading:this.props.loading,showStateLozenge:"ALL"===this.state.stateFilter})));return c.default.createElement("div",{className:"pull-request-list"},e)}}]);return d}(n.Component);h.default=k;u.exports=h["default"]});