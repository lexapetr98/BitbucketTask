@import "/static/global.less";

.key-avatar {
    margin-right: @baseSpacing;
    background: transparent url(access-key-avatar.svg) no-repeat center;

    &.aui-avatar-small {
        .square(@avatar-size-small);
        .border-radius(3px);
        // The background needs to overflow the box slightly, since the image is square, but we want it round
        background-size: @avatar-size-small + 2px;
    }

    &.aui-avatar-xsmall {
        .square(@avatar-size-xsmall);
        .border-radius(2px);
        // The background needs to overflow the box slightly, since the image is square, but we want it round
        background-size: @avatar-size-xsmall + 2px;
    }
}

.group-avatar {
    &.aui-avatar-xxxlarge {
        .square(@avatar-size-xxxlarge);
        background: transparent url(avatar/group-avatar-256.png) no-repeat 0 0;
        background-size: @avatar-size-xxxlarge;
    }

    &.aui-avatar-large {
        .square(@avatar-size-large);
        background: transparent url(avatar/group-avatar-96.png) no-repeat 0 0;
        background-size: @avatar-size-large;
    }

    &.aui-avatar-medium {
        .square(@avatar-size-medium);
        background: transparent url(avatar/group-avatar-64.png) no-repeat 0 0;
        background-size: @avatar-size-medium;
    }

    &.aui-avatar-small {
        .square(@avatar-size-small);
        .border-radius(3px);
        background: transparent url(avatar/group-avatar-48.png) no-repeat 0 0;
        background-size: @avatar-size-small;
    }

    &.aui-avatar-xsmall {
        .square(@avatar-size-xsmall);
        .border-radius(2px);
        background: transparent url(avatar/group-avatar-32.png) no-repeat 0 0;
        background-size: @avatar-size-xsmall;
    }
}

.aui-avatar-badged {
    position: relative;
    vertical-align: middle;

    &.avatar-dimmed > .aui-avatar-inner > img {
        opacity: 0.5;
        .transition(opacity 0.3s ease-in-out);
    }

    @badgeSize: 16px;
    @borderWidth: 2px;

    .approved, .needs-work {
        background: @invertedBodyTextColor 0 0;
        background-position: -@borderWidth;
        background-size: @avatar-size-xsmall;
        border: @borderWidth solid @invertedBodyTextColor;
        border-radius: 100%;
        opacity: 1;
        transition: all 0.2s cubic-bezier(.14,.01,.65,1.61);
        transition-property: opacity, transform;
        transform: scale(1);
        .square(@badgeSize - (2 * @borderWidth));
        color: @invertedBodyTextColor;
        position: absolute;
        right: -@badgeSize/2;
        top: -@badgeSize/2;
        text-align: center;
        display: block;
        font-size: @font-size-xsmall;
        line-height: @font-size-large;
        text-indent: -999em;
    }

    .approved {
        background-image: url(../com.atlassian.bitbucket.server.bitbucket-web:icons/icon-approved.svg);
    }

    .needs-work {
        background-image: url(../com.atlassian.bitbucket.server.bitbucket-web:icons/icon-needs-work.svg);
    }

    &.badge-hidden {
        &.avatar-dimmed > .aui-avatar-inner > img {
            opacity: 1;
        }

        .badge {
            opacity: 0;
            .scale(0);
        }
    }
}

.avatar-with-name {
    overflow: hidden;
    text-overflow: ellipsis;
    vertical-align: middle;

    .aui-avatar {
        vertical-align: middle;
    }

    &.deleted-user {
        text-decoration: line-through;
    }
}

.gravatar-notice {
    margin-top: @halfSpacing;
    font-size: @font-size-small;
    color: @secondaryTextColor;
    text-align: center;
    display: block;
    width: 100%;
}

.bitbucket-theme .aui-avatar img {
    //Prevent overflowing alt text on first load of avatars in firefox - https://jira.atlassian.com/browse/STASHDEV-3898
    -moz-force-broken-image-icon: 1;
}
