define("bitbucket/internal/widget/markup-editor/markup-editor","module exports @atlassian/aui jquery lodash bitbucket/internal/util/async-element-resize-helper bitbucket/internal/util/events bitbucket/internal/widget/markup-attachments/markup-attachments bitbucket/internal/widget/markup-preview/markup-preview bitbucket/internal/widget/mentionable-textarea/mentionable-textarea".split(" "),function(m,f,n,p,q,r,t,u,v,w){function b(a){this.init.apply(this,arguments)}Object.defineProperty(f,"__esModule",
{value:!0});var l=babelHelpers.interopRequireDefault(n),g=babelHelpers.interopRequireDefault(p),c=babelHelpers.interopRequireDefault(q),x=babelHelpers.interopRequireDefault(r),h=babelHelpers.interopRequireDefault(t),k=babelHelpers.interopRequireDefault(u),y=babelHelpers.interopRequireDefault(v),z=babelHelpers.interopRequireDefault(w),d=[];b._dataKey="markup-editor";b.bindTo=function(a){a=b.unbindFrom(a);var e=new b(a);a.data(b._dataKey,e);return e};b.unbindFrom=function(a){a=(0,g.default)(a);a=a.is(".markup-editor")?
a:a.find(".markup-editor");var e=a.data(b._dataKey);e&&e.destroy();return a};b.registerExtension=function(a){c.default.includes(d,a)||d.push(a)};b.deregisterExtension=function(a){d=c.default.without(d,a)};h.default.addLocalEventMixin(b.prototype);b.prototype.init=function(a){a=(0,g.default)(a);this.$editor=a.is(".markup-editor")?a:a.find(".markup-editor");this._destroyables=[];a=this.$editor.find("textarea");a.is(document.activeElement)&&c.default.defer(a.focus.bind(a));a=this.$editor.find("textarea.expanding").expandingTextarea();
this._destroyables.push(h.default.chainWith(a).on("resize.expanding",this.onComponentResize.bind(this,!1)));this._destroyables.push({destroy:a.expandingTextarea.bind(a,"destroy")});a=new y.default(this.$editor);this._destroyables.push(h.default.chainWith(a).on("resize",this.onComponentResize.bind(this,!0)));this._destroyables.push(a);this._destroyables.push(new z.default({$container:this.$editor}));a=function(a){this.$editor.find(".markup-attachments-button").addClass("disabled").prop("disabled",
"disabled").attr("aria-disabled",!0).attr("title",a)}.bind(this);k.default.isEnabled()?k.default.isSupported()?this._destroyables.push(new k.default(this.$editor)):a(l.default.I18n.getText("bitbucket.web.markup.attachments.unsupported")):a(l.default.I18n.getText("bitbucket.web.markup.attachments.disabled"));d.forEach(function(a){a.init(this.$editor);c.default.isFunction(a.destroy)&&this._destroyables.push({destroy:c.default.partial(a.destroy,this.$editor)})}.bind(this));this.$editor.find(".markup-preview-help").tooltip({gravity:g.default.fn.tipsy.autoNS})};
b.prototype.onComponentResize=function(a){var b=this;(0,x.default)(this.$editor[0],function(){b.$editor.triggerHandler("resize");b.trigger("resize",a)})};b.prototype.destroy=function(){c.default.invokeMap(this._destroyables,"destroy");this.$editor.data(b._dataKey,null);this.$editor=null;this.off()};f.default=b;m.exports=f["default"]});