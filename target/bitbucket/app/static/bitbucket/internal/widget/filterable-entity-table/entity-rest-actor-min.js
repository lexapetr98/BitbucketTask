define("bitbucket/internal/widget/filterable-entity-table/entity-rest-actor",["exports","icepick","bitbucket/util/server","bitbucket/internal/bbui/paged-table/paged-table","bitbucket/internal/util/analytics"],function(a,e,l,t,u){Object.defineProperty(a,"__esModule",{value:!0});a.loadEntitiesRestActor=a.searchResponseTransformer=void 0;var v=babelHelpers.interopRequireDefault(u);a.searchResponseTransformer=function(w){return function(a){var c=a[w];return c?(0,e.set)(c,"nextPageStart",c.nextPageStart||
c.nextStart):a}};a.loadEntitiesRestActor=function(a){var m=a.loadAction,c=a.urlBuilder,f=a.fallbackBuilder,n=a.responseTransformer,e=a.statusCode,g=!1;return function(a,h){var k=a.type,b=a.payload;b=void 0===b?{}:b;var p=a.meta;if(k===m){a=b.start;var q=void 0===a?0:a;a=b.limit;var r=void 0===a?t.DEFAULT_PAGE_SIZE:a,d=b.filter;b=function(){g=!0;h({type:m+"_FALLBACK"});v.default.add("entity-rest-actor.fallback.used");return(0,l.rest)({url:f({filter:d}).withParams({start:q,limit:r}).build()})};(0,l.rest)({url:(g?
f:c)({filter:d}).withParams({start:q,limit:r}).build(),statusCode:babelHelpers.extends({},e,!g&&f&&{"*":function(a,b){return"error"===b&&a&&400<=a.status?!0:!1},404:b,500:b,503:b})}).done(function(a){h({type:k+"_SUCCESS",payload:n?n(a):a,meta:babelHelpers.extends({},p,{filter:d})})}).fail(function(a){h({type:k+"_FAILURE",payload:a,meta:babelHelpers.extends({},p,{filter:d})})})}}}});