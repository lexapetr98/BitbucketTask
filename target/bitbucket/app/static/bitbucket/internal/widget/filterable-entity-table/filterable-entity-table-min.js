define("bitbucket/internal/widget/filterable-entity-table/filterable-entity-table","exports @atlassian/aui classnames lodash prop-types react react-redux bitbucket/internal/bbui/paged-table/paged-table bitbucket/internal/util/dom-event bitbucket/internal/util/scroll bitbucket/internal/util/shortcuts ./action-creators ./selectors".split(" "),function(e,h,a,k,u,n,v,l,J,K,w,x,y){Object.defineProperty(e,"__esModule",{value:!0});e.connectEntityTable=e.filterableOverrideMerge=void 0;var E=babelHelpers.interopRequireDefault(a);
a=babelHelpers.interopRequireDefault(u);var f=babelHelpers.interopRequireDefault(n),A=babelHelpers.interopRequireDefault(l),B=babelHelpers.interopRequireWildcard(w).createKeyboardShortcutsHandler,z=e.filterableOverrideMerge=function(a,d,p){return babelHelpers.extends({},p,(0,k.omit)(a,"filterable"),d,{filterable:(0,k.isBoolean)(a.filterable)?a.filterable:p.filterable})};e.connectEntityTable=function(a,d,p){return(0,v.connect)((0,y.getStateForEntity)(a),(0,x.entityActionCreators)(d),z)(p)};l=function(a){function d(){var a,
b,c,f;babelHelpers.classCallCheck(this,d);for(var e=arguments.length,m=Array(e),g=0;g<e;g++)m[g]=arguments[g];return f=(b=(c=babelHelpers.possibleConstructorReturn(this,(a=d.__proto__||Object.getPrototypeOf(d)).call.apply(a,[this].concat(m))),c),c.state={focusedEntity:null,filterFocused:!1,filter:null,entities:null},c.onFilterChange=(0,k.debounce)(function(b){return c.props.setFilter(b)},250),c.blurFilter=function(){return c.setState({filterFocused:!1})},c.focusFilter=function(){return c.setState({filterFocused:!0})},
c.focusNext=function(){var b=c.props.entities;c.setState(function(a){return{focusedEntity:b[Math.min(b.indexOf(a.focusedEntity)+1,b.length-1)]}})},c.focusPrev=function(){var b=c.props.entities;c.setState(function(a){return{focusedEntity:b[Math.max(b.indexOf(a.focusedEntity)-1,0)]}})},c.open=function(){c._openHandler&&c._openHandler()},c.onKeydown=B({f:c.focusFilter,j:c.focusNext,k:c.focusPrev,o:c.open}),b),babelHelpers.possibleConstructorReturn(c,f)}babelHelpers.inherits(d,a);babelHelpers.createClass(d,
[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeydown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeydown)}},{key:"render",value:function(){var a=this,b=this.props,c=b.bufferPx,d=b.className,e=b.emptyState,m=b.entities,g=b.filter,h=b.filterable,k=b.filterPlaceholder,l=b.header,n=b.isLastPage,u=b.lastPageMessage,q=b.limit,C=void 0===q?this.props.pageSize:q,v=b.loadEntities;q=b.loading;var w=b.loadMoreMessage,
x=b.nextPageStart,y=b.noItemsMessage,r=b.row;r=void 0===r?this.row:r;var F=b.scrollToLoad,z=b.shouldScrollOnFocus,G=b.scrollElement;b=b.showTableIfNoResults;var t=this.state,D=t.filterFocused;t=t.focusedEntity;var H=!(!g&&!m.length);return!g&&!m.length&&n&&e?e:f.default.createElement("div",{className:(0,E.default)(d,"filterable-entity-table")},h&&H&&f.default.createElement(I,{onKeyDown:B({ArrowDown:this.focusNext,ArrowUp:this.focusPrev,Enter:this.open}),onInput:function(b){return a.onFilterChange(b.target.value)},
onBlur:this.blurFilter,onFocus:this.focusFilter,focused:D,placeholder:k}),f.default.createElement(A.default,{allFetched:n,allFetchedMessage:u,bufferPx:c,className:"entity-table",focusedIndex:m.indexOf(t),header:l,items:m,loading:q,loadMoreMessage:w,noItemsMessage:y,onMoreItemsRequested:function(){return v({filter:g,start:x,limit:C})},pageSize:C,row:r,openCallback:function(b){return a._openHandler=b},scrollElement:G,scrollToLoad:F,shouldScrollOnFocus:z,shouldNativeFocus:!D,showTableIfNoResults:b}))}}],
[{key:"getDerivedStateFromProps",value:function(a,b){var c=a.entities;a=a.filter;var d={entities:c,filter:a};if(!b.focusedEntity||(0,k.get)(a,"length",0)<b.filter.length||c.length&&!(0,k.includes)(c,b.focusedEntity)||!b.filter&&a&&b.focusedEntity===b.entities[0])d.focusedEntity=c[0];return d}}]);return d}(n.PureComponent);l.propTypes={bufferPx:a.default.number,className:a.default.string,emptyState:a.default.element,entities:a.default.array,filter:a.default.string,filterable:a.default.bool,filterPlaceholder:a.default.string,
header:a.default.func,isLastPage:a.default.bool,lastPageMessage:a.default.string,limit:a.default.number,loadEntities:a.default.func,loading:a.default.bool,loadMoreMessage:a.default.string,nextPageStart:a.default.number,noItemsMessage:a.default.string,pageSize:a.default.number,row:a.default.func,scrollToLoad:a.default.bool,scrollElement:A.default.propTypes.scrollElement,shouldScrollOnFocus:a.default.bool,showTableIfNoResults:a.default.bool};l.defaultProps={filterable:!1,header:function(){return f.default.createElement("tr",
null,f.default.createElement("th",null,h.I18n.getText("bitbucket.web.entity.col.name")))},isLastPage:!1,lastPageMessage:h.I18n.getText("bitbucket.web.entity.allfetched"),loading:!1,loadMoreMessage:h.I18n.getText("bitbucket.web.entity.loadmore"),noItemsMessage:h.I18n.getText("bitbucket.web.entity.nonefound"),filterPlaceholder:h.I18n.getText("bitbucket.web.entity.filter.placeholder"),scrollElement:window,scrollToLoad:!0,shouldScrollOnFocus:!0,showTableIfNoResults:!0};e.default=l;var I=function(a){function d(){babelHelpers.classCallCheck(this,
d);return babelHelpers.possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}babelHelpers.inherits(d,a);babelHelpers.createClass(d,[{key:"componentDidMount",value:function(){this.props.focused&&this.input.focus()}},{key:"componentDidUpdate",value:function(a){a=a.focused;this.props.focused&&!a&&this.input.focus()}},{key:"componentWillUnmount",value:function(){if(this.props.onBlur)this.props.onBlur()}},{key:"render",value:function(){var a=this,b=this.props;return f.default.createElement("div",
{className:"paged-table-filter"},f.default.createElement("input",{className:"paged-table-filter-input",onBlur:b.onBlur,onFocus:b.onFocus,onInput:b.onInput,onKeyDown:b.onKeyDown,placeholder:b.placeholder,ref:function(b){a.input=b}}))}}]);return d}(n.PureComponent)});