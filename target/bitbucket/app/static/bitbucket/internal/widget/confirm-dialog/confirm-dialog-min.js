define("bitbucket/internal/widget/confirm-dialog/confirm-dialog","module exports @atlassian/aui jquery bitbucket/internal/util/ajax bitbucket/internal/widget/submit-spinner/submit-spinner".split(" "),function(h,d,f,b,k,l){Object.defineProperty(d,"__esModule",{value:!0});var e=babelHelpers.interopRequireDefault(b),q=babelHelpers.interopRequireDefault(k),r=babelHelpers.interopRequireDefault(l);b=function(){function b(a,m){babelHelpers.classCallCheck(this,b);this.dialogOptions=babelHelpers.extends({},
b.dialogDefaults,a);this.ajaxOptions=m||{};this._selectors=[];this._okCallbacks=e.default.Callbacks();this._cancelCallback=e.default.Callbacks();this._detachers=e.default.Callbacks()}babelHelpers.createClass(b,[{key:"getConfirmButton",value:function(){return(0,e.default)("#"+this.dialogOptions.id+" ."+this.dialogOptions.confirmButtonClass)}},{key:"getButtons",value:function(){var a=this.getConfirmButton(),b=this.dialogOptions.id;a=a.add("#"+b+" .confirm-dialog-cancel");this._selectors.forEach(function(e){a=
a.add("#"+b+" "+e)});return a}},{key:"setButtonsDisabled",value:function(a){this.getButtons().attr({disabled:a}).toggleClass("disabled",a)}},{key:"remove",value:function(){this._dialog&&(this.setButtonsDisabled(!1),this._dialog.$el.data("aui-remove-on-hide")?this._dialog.hide():this._dialog.remove(),this._dialog=null)}},{key:"destroy",value:function(){this.remove();this._detachers.fire();this._detachers=null}},{key:"getContentElement",value:function(){return this._dialog?this._dialog.$el.find(".aui-dialog2-content").get(0):
null}},{key:"attachTo",value:function(a,b,d){var c=this,g=this.dialogOptions,h=this.ajaxOptions,k=this._okCallbacks,l=this._cancelCallback;d=d||document;var n=(0,e.default)(d);this._selectors.push(a);var m=function(a){c.setButtonsDisabled(!0);var b=null,e=new r.default(c.getConfirmButton(),"before");g.submitToHref&&(e.show(),a.is("a")?b=q.default.rest(babelHelpers.extends({url:a.attr("href")},h)).always(function(){e.hide();c.remove()}):a.closest("form").submit());k.fire(b,a,function(){c.remove()},
c._dialog,e)},p=function(a){a.preventDefault();var d=(0,e.default)(a.currentTarget);d.is(":disabled")||(c._dialog=(0,f.dialog2)(bitbucket.internal.dialogs.confirm(babelHelpers.extends({},g,{modal:!0}))),c._dialog.$el.on("click",".confirm-dialog-submit",function(a){m(d)}).on("click",".confirm-dialog-cancel",function(a){c.remove();l.fire(d)}).on("keydown",function(a){a.keyCode===f.keyCode.ESCAPE&&(a.preventDefault(),c.remove())}),c._dialog.show(),g.focusSelector&&c._dialog.$el.find(g.focusSelector).focus(),
b&&b(d.get(0),c._dialog,c))};n.on("click",a,p);this._detachers.add(function(){n.off("click",a,p)})}},{key:"addConfirmListener",value:function(a){this._okCallbacks.add(a)}},{key:"addCancelListener",value:function(a){this._cancelCallback.add(a)}}]);return b}();b.dialogDefaults={id:null,titleText:f.I18n.getText("bitbucket.web.title.confirm"),titleClass:"confirm-header",confirmButtonClass:"confirm-button",panelContent:"\x3cp\x3e"+f.I18n.getText("bitbucket.web.dialog.confirm")+"\x3c/p\x3e",panelClass:"panel-body",
submitText:f.I18n.getText("bitbucket.web.button.confirm"),submitToHref:!0,focusSelector:".confirm-button"};d.default=b;h.exports=d["default"]});