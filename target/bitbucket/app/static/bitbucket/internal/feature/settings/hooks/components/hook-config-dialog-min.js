define("bitbucket/internal/feature/settings/hooks/components/hook-config-dialog","module exports @atlassian/aui classnames lodash react react-dom bitbucket/internal/bbui/aui-react/dialog bitbucket/internal/bbui/aui-react/spinner bitbucket/internal/util/form ../hook-config-form-util".split(" "),function(w,l,m,n,k,p,x,q,r,y,z){Object.defineProperty(l,"__esModule",{value:!0});var A=babelHelpers.interopRequireDefault(n),d=babelHelpers.interopRequireDefault(p),B=babelHelpers.interopRequireDefault(q),t=
babelHelpers.interopRequireDefault(r),C=babelHelpers.interopRequireDefault(z),D=["button","input","select","textarea"].map(function(a){return a+":enabled"}).join(","),E=function(a){return Array.isArray(a)?a:[a]},u=function(a){return(0,A.default)("aui-button",babelHelpers.defineProperty({},"aui-button-"+a,a))},v=function(a){a=a.errors;return d.default.createElement("div",{className:"errors-container"},E(void 0===a?[]:a).map(function(a){return d.default.createElement("div",{key:a,className:"aui-message aui-message-error"},
d.default.createElement("p",null,a))}))},G=function(a){var e=a.enabled,F=a.ready,c=a.saving,b=a.onCancel;a=a.onSave;return d.default.createElement("div",null,d.default.createElement("button",{className:u("primary"),disabled:!F||c,onClick:a},c&&d.default.createElement(t.default,null),e?m.I18n.getText("bitbucket.web.button.save"):m.I18n.getText("bitbucket.web.button.enable")),d.default.createElement("button",{className:u("link"),disabled:c,onClick:b,autoFocus:!0},m.I18n.getText("bitbucket.web.button.cancel")))},
H=function(a){function e(){var a,c,b,d;babelHelpers.classCallCheck(this,e);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return d=(c=(b=babelHelpers.possibleConstructorReturn(this,(a=e.__proto__||Object.getPrototypeOf(e)).call.apply(a,[this].concat(g))),b),b.evalConfigScripts=(0,k.debounce)(function(){if(b.form){var a=b.form.querySelectorAll(".html-contents script");(0,k.forEach)(a,function(b){return eval(b.innerHTML)})}},100),c),babelHelpers.possibleConstructorReturn(b,d)}babelHelpers.inherits(e,
a);babelHelpers.createClass(e,[{key:"componentDidMount",value:function(){var a=this.form.querySelector(D);a&&a.focus();this.evalConfigScripts()}},{key:"componentDidUpdate",value:function(){this.evalConfigScripts()}},{key:"render",value:function(){var a=this,c=this.props,b=c.children;return d.default.createElement("form",{ref:function(b){a.form=b},className:"aui",onSubmit:function(a){return a.preventDefault()}},d.default.createElement(v,{errors:c.errors}),b)}}]);return e}(p.Component);n=function(a){function e(){var a,
c,b,d;babelHelpers.classCallCheck(this,e);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return d=(c=(b=babelHelpers.possibleConstructorReturn(this,(a=e.__proto__||Object.getPrototypeOf(e)).call.apply(a,[this].concat(g))),b),b.state={formContent:void 0,view:void 0,viewError:void 0},b.onCancel=function(){var a=b.props,c=a.hook;(a=a.onCancel)&&a(c)},b.onSave=function(){var a=b.props,c=a.hook;(a=a.onSave)&&b.configForm&&a(c,(0,y.formToJSON)((0,x.findDOMNode)(b.configForm)))},b.safeSetState=
function(a){b.mounted&&b.setState(a,function(){return b.updateFormContent(b.props)})},b.updateFormContent=function(a){b.setState(e.getDerivedStateFromProps(a,b.state))},c),babelHelpers.possibleConstructorReturn(b,d)}babelHelpers.inherits(e,a);babelHelpers.createClass(e,[{key:"componentDidMount",value:function(){var a=this;this.mounted=!0;(0,C.default)(this.props.hook).done(function(c){return a.safeSetState({view:c})}).fail(function(c){return a.safeSetState({viewError:c})})}},{key:"componentWillUnmount",
value:function(){this.mounted=!1}},{key:"render",value:function(){var a=this,c=this.props,b=c.errors.formErrors,e=c.hook,f=this.state,g=f.formContent;f=f.viewError;return d.default.createElement(B.default,{id:"hook-config-dialog",size:q.DialogSize.LARGE,modal:!0,titleContent:e.details.name,footerActionContent:d.default.createElement(G,{enabled:e.enabled,ready:g&&!f,saving:c.saving,onCancel:this.onCancel,onSave:this.onSave})},f?d.default.createElement(v,{errors:f.message}):g?d.default.createElement(H,
{ref:function(b){a.configForm=b},errors:b},g):d.default.createElement(t.default,{size:r.SpinnerSize.LARGE}))}}],[{key:"getDerivedStateFromProps",value:function(a,c){var b=a.config;c=c.view;if(!b||!c)return{formContent:void 0};a=c({config:b,errors:a.errors.fieldErrors,scope:a.currentScope});return(0,k.isError)(a)?{viewError:a}:(0,k.isString)(a)?{formContent:d.default.createElement("div",{className:"html-contents",dangerouslySetInnerHTML:{__html:a}})}:{formContent:a}}}]);return e}(p.Component);l.default=
n;w.exports=l["default"]});