define("bitbucket/internal/feature/readme/common/readme-common","exports jquery lodash bitbucket/util/navbuilder bitbucket/internal/model/page-state bitbucket/internal/util/text".split(" "),function(b,f,e,n,p,q){Object.defineProperty(b,"__esModule",{value:!0});b.onReady=b.DATA=b.updateLinks=b.createUrl=void 0;f=babelHelpers.interopRequireDefault(f);var h=babelHelpers.interopRequireDefault(n),k=babelHelpers.interopRequireDefault(p),r=babelHelpers.interopRequireDefault(q),l=f.default.Deferred(),m=function(a,
b,c){var d="",g=a.indexOf("#");-1!==g&&(d=a.substr(g),a=a.substr(0,g));return a+((0,e.includes)(a,"?")?"\x26":"?")+encodeURIComponent(b)+"\x3d"+encodeURIComponent(c)+d},t=function(a,b,c,d){!a||r.default.isUriAbsolute(a)||(0,e.startsWith)(a,"#")||(!c||(0,e.endsWith)(c,"/")||(0,e.startsWith)(a,"/")||(a=c+"/"+a),k.default.getRevisionRef().isDefault()||(a=m(a,"at",b)),a=d?d(a):a);return a};b.createUrl=function(a,b,c){b={blob:c,at:b,markup:!0,htmlEscape:!1,hardwrap:!1};return h.default.rest().currentRepo().raw().path(a).withParams(b).build()};
b.updateLinks=function(a,b){var c=function(d,c,e){var f=k.default.getRevisionRef().getId();a.find(d).each(function(a,d){d.setAttribute(c,t(d.getAttribute(c),f,b,e))})};c("a","href");c("img","src",function(a){return 0===h.default.parse(a).getQueryParamValues("raw").length?m(a,"raw",""):a});return a};b.DATA=l;b.onReady=function(){_PageDataPlugin.ready("com.atlassian.bitbucket.server.bitbucket-web:markup-extension-provider","bitbucket.layout.repository",function(a){return l.resolve(a)})}});