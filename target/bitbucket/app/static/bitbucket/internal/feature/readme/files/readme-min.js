define("bitbucket/internal/feature/readme/files/readme","exports @atlassian/aui jquery lodash bitbucket/internal/feature/readme/common/readme-common bitbucket/internal/model/path bitbucket/internal/util/ajax bitbucket/internal/util/events bitbucket/internal/util/syntax-highlight".split(" "),function(h,t,u,f,m,v,w,x,y){Object.defineProperty(h,"__esModule",{value:!0});h.onReady=void 0;var n=babelHelpers.interopRequireDefault(t),l=babelHelpers.interopRequireDefault(u),p=babelHelpers.interopRequireDefault(v),
z=babelHelpers.interopRequireDefault(w),d=babelHelpers.interopRequireDefault(x),A=babelHelpers.interopRequireDefault(y),k,B=function(c,b){var g=b.name;b=b.extensions;c=c.filter(function(a){var b=a.name;a=a.type;b=b.toUpperCase();return(b===g||(0,f.startsWith)(b,g+"."))&&"FILE"===a});var d=(0,f.groupBy)(c,function(a){return(new p.default(a.name)).getExtension().toUpperCase()});return b.map(function(a){return(0,f.head)(d[a.toUpperCase()])}).filter(function(a){return a})[0]},q={abort:l.default.noop},
r=function(c){var b=c.files,g=c.path,h=c.revision;m.DATA.then(function(a){return B(b,a)}).done(function(a){if(a){var b=k.find(".filebrowser-readme-content").empty();k.find(".filebrowser-readme-title").text(a.name);var c=function(){e();return!1},f=function(a){k.show();b.html((0,m.updateLinks)((0,l.default)(a),window.location.pathname));A.default.container(b);d.default.trigger("bitbucket.internal.feature.readme.rendered")};g=new p.default(g);q=z.default.rest({url:(0,m.createUrl)(g.getComponents().concat(a.name),
h,a.contentId),dataType:"html",statusCode:{400:c,413:function(){f(n.default.messages.warning({body:n.default.I18n.getText("bitbucket.web.sourceview.readme.toolarge"),closeable:!1}));return!1},415:c,500:c}}).done(function(a){l.default.trim(a)?f(a):e()})}})},e=function(){q.abort();k.hide()};h.onReady=function(c){var b;k=(0,l.default)(c).html(bitbucket.internal.feature.readme.readme());e();d.default.on("bitbucket.internal.page.filebrowser.revisionRefChanged",e);d.default.on("bitbucket.internal.page.filebrowser.urlChanged",
e);d.default.on("bitbucket.internal.feature.filetable.showSpinner",e);d.default.on("bitbucket.internal.feature.filebrowser.filesChanged",function(c){b=c;r(c)});d.default.on("bitbucket.internal.feature.filetable.showFind",e);d.default.on("bitbucket.internal.feature.filetable.hideFind",function(){b&&r(b)})}});