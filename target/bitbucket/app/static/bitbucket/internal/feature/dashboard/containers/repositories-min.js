define("bitbucket/internal/feature/dashboard/containers/repositories","exports @atlassian/aui classnames lodash react react-redux redux bitbucket/util/events bitbucket/util/navbuilder bitbucket/internal/util/error-boundary bitbucket/internal/util/i18n-html bitbucket/internal/util/text ../action-creators/repository-list-navigation ../components/repository-list ../components/repository-search ../repository-type ../selectors/repositories".split(" "),function(f,d,h,v,l,w,x,y,z,A,B,C,D,E,F,n,r){function G(c){var d=
c.nextStart;return d/(d-c.start)+1}Object.defineProperty(f,"__esModule",{value:!0});f.Repositories=void 0;var H=babelHelpers.interopRequireDefault(h),c=babelHelpers.interopRequireDefault(l),m=babelHelpers.interopRequireDefault(y),t=babelHelpers.interopRequireDefault(z),I=babelHelpers.interopRequireDefault(A),J=babelHelpers.interopRequireDefault(B),K=babelHelpers.interopRequireDefault(D),L=babelHelpers.interopRequireDefault(E),M=babelHelpers.interopRequireDefault(F),N=function(){return c.default.createElement("div",
{className:"dashboard-search-repo-empty"},c.default.createElement("p",null,d.I18n.getText("bitbucket.web.dashboard.repositories.search.empty")))},O=function(){return c.default.createElement("div",{className:"dashboard-recent-repo-empty"},c.default.createElement("p",null,d.I18n.getText("bitbucket.web.dashboard.repositories.recent.empty.message")),c.default.createElement("p",{className:"empty-action",dangerouslySetInnerHTML:{__html:d.I18n.getText("bitbucket.web.dashboard.repositories.recent.empty.action.html",
t.default.allProjects().build())}}))},u=function(){return c.default.createElement("div",{className:"dashboard-search-repo-error"},c.default.createElement("div",{className:"warning-icon"}),c.default.createElement("div",{className:"error-text"},c.default.createElement("div",{className:"error-text-primary"},d.I18n.getText("bitbucket.web.dashboard.repositories.search.error")),c.default.createElement("div",{className:"error-text-secondary"},d.I18n.getText("bitbucket.web.dashboard.repositories.search.error.message"))))};
h=f.Repositories=function(a){function e(){var b,c,p,d;babelHelpers.classCallCheck(this,e);for(var a=arguments.length,k=Array(a),g=0;g<a;g++)k[g]=arguments[g];return d=(c=(p=babelHelpers.possibleConstructorReturn(this,(b=e.__proto__||Object.getPrototypeOf(e)).call.apply(b,[this].concat(k))),p),p.state={},c),babelHelpers.possibleConstructorReturn(p,d)}babelHelpers.inherits(e,a);babelHelpers.createClass(e,[{key:"onMoreClick",value:function(){var b=this.props.paging;m.default.trigger("bitbucket.internal.ui.nav.pagination",
null,{context:"dashboard-repository-list",page:G(b)});b.loadMore&&b.loadMore()}},{key:"onRepositoryListItemClick",value:function(b){b=b.target.dataset;var c=b.repositoryId,d=b.projectId,a=this.props.activeRepositoryType,e="bitbucket.internal.ui.dashboard.repository-list.repository.clicked";"project"===b.entity&&(e="bitbucket.internal.ui.dashboard.repository-list.project.clicked");m.default.trigger(e,null,{source:"link",activeRepositoryType:a,repositoryId:c,projectId:d})}},{key:"onSearchFieldKeyDown",
value:function(b){var c=b.keyCode,a=this.props,e=a.repositories,f=a.focusedIndex;a=a.activeRepositoryType;c===d.keyCode.ENTER?(b.preventDefault(),b.nativeEvent.stopImmediatePropagation(),b=e[f],m.default.trigger("bitbucket.internal.ui.dashboard.repository-list.repository.clicked",null,{source:"keyboard-shortcut",activeRepositoryType:a}),this._navigateToURL(t.default.project(b.project).repo(b).build())):c===d.keyCode.ESCAPE?(b.preventDefault(),b.target.blur()):this.props.repositoryNavigation({event:b})}},
{key:"onSearchFieldFocus",value:function(b){this.props.repositoryNavigation({event:b})}},{key:"onSearchFieldBlur",value:function(b){this.props.repositoryNavigation({event:b})}},{key:"onQueryChange",value:function(b){this.setState({query:b})}},{key:"onScroll",value:function(b){this.setState({scrolled:0<b})}},{key:"_navigateToURL",value:function(b){window.location.href=b}},{key:"render",value:function(){var b=this,a=this.props,e=a.activeRepositoryType,f=a.focusedIndex,h=a.isLoading,k=a.paging,g=a.repositories,
q=this.state,m=q.query;q=q.scrolled;var l=void 0;l=a.hasError?c.default.createElement(u,null):e===n.RECENT?c.default.createElement(O,null):c.default.createElement(N,null);a=void 0;switch(e){case n.RECENT:a=c.default.createElement("h4",{className:"title"},d.I18n.getText("bitbucket.web.dashboard.repositories.list.recent.title"));break;case n.SEARCH:a=g?c.default.createElement(J.default,{tag:"h4",className:"results",params:[(0,C.capInt)(k.count,999)]},d.I18n.getText("bitbucket.web.dashboard.repositories.list.search.title.html")):
null}return c.default.createElement("div",{id:"dashboard-repositories",className:(0,H.default)("dashboard-repositories",{scrolled:q})},c.default.createElement("h3",null,d.I18n.getText("bitbucket.web.dashboard.repositories.title")),c.default.createElement(M.default,{onKeyDown:function(a){return b.onSearchFieldKeyDown(a)},onBlur:function(a){return b.onSearchFieldBlur(a)},onFocus:function(a){return b.onSearchFieldFocus(a)},onQueryChange:function(a){return b.onQueryChange(a)},pageSize:25}),c.default.createElement(I.default,
{renderFallback:function(a,d){return b.state.query?c.default.createElement(u,null):d}},c.default.createElement(L.default,{repositories:g,title:a,showMore:e!==n.RECENT&&!k.isLastPage&&!h,nextPageSize:Math.min(k.count-(0,v.get)(g,"length",0),25),onMoreClick:function(){return b.onMoreClick()},focusedIndex:f,onItemClick:function(a){return b.onRepositoryListItemClick(a)},EmptyState:l,query:m,onScroll:function(a){return b.onScroll(a)}})))}}]);return e}(l.Component);h.defaultProps={paging:{isLastPage:!0}};
f.default=(0,w.connect)(function(a){return{activeRepositoryType:a.ui.repositories.activeType,hasError:a.ui.repositories.hasError,focusedIndex:a.ui.repositories.focusedIndex,isLoading:a.ui.repositories.loading,paging:(0,r.repositoriesPagingSelector)(a),repositories:(0,r.repositoriesSelector)(a)}},function(a){return(0,x.bindActionCreators)({repositoryNavigation:K.default},a)})(h)});