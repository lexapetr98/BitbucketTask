define("bitbucket/internal/feature/changeset/diff-tree/store/reducers",["module","exports","lodash","bitbucket/internal/util/reducers","./constants"],function(l,g,h,e,b){Object.defineProperty(g,"__esModule",{value:!0});g.default=function(){var c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=arguments[1],f=m(c.list,a),b=n(c.selectedIndex,a,f),d=p(c.parents,a);a=q(c.collapsed,a,{parents:d,list:f,selectedIndex:b});return(0,e.preserveIfEquivalent)(c,{list:f,selectedIndex:b,parents:d,collapsed:a})};
var d,k=function(c,a){return Math.max(0,c.findIndex(function(c){return a===c.id}))},r=function(c,a){for(var b=[];c.hasOwnProperty(a);)b.unshift(a),a=c[a];return b},t=function(c,a,f){var d=!1,e=babelHelpers.extends({},c);(f?r(a,f.id):[]).forEach(function(a){c[a]!==b.NODE_EXPANDED&&(d=!0,e[a]=b.NODE_EXPANDED)});return d?e:c},u=(0,e.multiKeyedReducer)(function(c){return c.nodeId||null}),m=(0,e.reduceByType)([],babelHelpers.defineProperty({},b.UPDATE_LIST,function(c,a){return a.list})),n=(0,e.reduceByType)(0,
(d={},babelHelpers.defineProperty(d,b.UPDATE_LIST,function(c,a){c=a.list;a=a.defaultSelected;return(a=void 0===a?null:a)?k(c,a.id):0}),babelHelpers.defineProperty(d,b.SELECT_NEXT_ITEM,function(c,a,b){return(0,h.clamp)(c+1,0,b.length-1)}),babelHelpers.defineProperty(d,b.SELECT_PREV_ITEM,function(c,a,b){return(0,h.clamp)(c-1,0,b.length-1)}),babelHelpers.defineProperty(d,b.SELECT_ITEM,function(c,a,b){return k(b,a.selectedId)}),d)),p=(0,e.reduceByType)({},babelHelpers.defineProperty({},b.UPDATE_PARENTS_MAP,
function(c,a){return a.parents})),q=(0,e.reduceByTypes)({},[[b.TOGGLE_COLLAPSE,u(function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:b.NODE_EXPANDED)===b.NODE_EXPANDED?b.NODE_COLLAPSED:b.NODE_EXPANDED})],[[b.SELECT_ITEM,b.SELECT_NEXT_ITEM,b.SELECT_PREV_ITEM],function(c,a,b){return t(c,b.parents,b.list[b.selectedIndex])}]]);l.exports=g["default"]});