define("bitbucket/internal/feature/comments/anchors",["module","exports","jquery","bitbucket/util/navbuilder","bitbucket/internal/model/page-state"],function(h,e,k,l,m){function b(a){this._pullRequest=a?a.toJSON():f.default.getPullRequest().toJSON();this._projectKey=this._pullRequest.toRef.repository.project.key;this._repoSlug=this._pullRequest.toRef.repository.slug;this._pullRequestId=this._pullRequest.id}function c(a){this._path=a.getPath();this._srcPath=a.getSrcPath();this._commitRange=a.getCommitRange();
this._projectKey=(a.getRepository()||f.default).getProject().getKey();this._repoSlug=(a||f.default).getRepository().getSlug()}function d(a,n,b,c){this._diffAnchor=a;this._lineType=n;this._line=b;this._fileType=c}Object.defineProperty(e,"__esModule",{value:!0});var p=babelHelpers.interopRequireDefault(k),g=babelHelpers.interopRequireDefault(l),f=babelHelpers.interopRequireDefault(m);b.prototype.getPullRequest=function(){return this._pullRequest};b.prototype.getId=function(){return"pullrequest-"+this._projectKey+
"-"+this._repoSlug+"-"+this._pullRequestId};b.prototype.toJSON=function(){};b.prototype.urlBuilder=function(){return g.default.rest().project(this._projectKey).repo(this._repoSlug).pullRequest(this._pullRequestId).comments()};c.prototype.getPullRequest=function(){return this._commitRange.getPullRequest()&&this._commitRange.getPullRequest().toJSON()};c.prototype.getId=function(){return"diff-"+this._projectKey+"-"+this._repoSlug+"-"+this._commitRange.getId()+"-"+this._path};c.prototype.toJSON=function(){var a=
{path:this._path.toString(),diffType:this._commitRange.getDiffType()};"EFFECTIVE"!==this._commitRange.getDiffType()&&(a.fromHash=this._commitRange.getSinceRevision()&&this._commitRange.getSinceRevision().getId(),a.toHash=this._commitRange.getUntilRevision().getId());var b=this._srcPath&&this._srcPath.toString();b&&(a.srcPath=b);return a};c.prototype.urlBuilder=function(){var a=g.default.rest().project(this._projectKey).repo(this._repoSlug),b=this._commitRange.getPullRequest();return b?a.pullRequest(b.getId()).comments():
a.commit(this._commitRange.getUntilRevision().getId()).comments()};d.prototype.getPullRequest=function(){return this._diffAnchor.getPullRequest()};d.prototype.getId=function(){var a=this._fileType?this._fileType+"-":"";return"line-"+this._diffAnchor.getId()+"-"+a+this._lineType+"-"+this._line};d.prototype.toJSON=function(){var a=p.default.extend(this._diffAnchor.toJSON(),{line:this._line,lineType:this._lineType});this._fileType&&(a.fileType=this._fileType);return a};d.prototype.urlBuilder=function(){return this._diffAnchor.urlBuilder()};
e.default={PullRequestAnchor:b,DiffAnchor:c,LineAnchor:d};h.exports=e["default"]});