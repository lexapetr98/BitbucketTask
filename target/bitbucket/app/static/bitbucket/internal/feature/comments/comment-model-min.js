define("bitbucket/internal/feature/comments/comment-model","module exports @atlassian/aui backbone backbone-brace lodash bitbucket/util/navbuilder".split(" "),function(h,e,b,k,l,m,n){Object.defineProperty(e,"__esModule",{value:!0});var d=babelHelpers.interopRequireDefault(b),p=babelHelpers.interopRequireDefault(k),f=babelHelpers.interopRequireDefault(l),g=babelHelpers.interopRequireDefault(m),q=babelHelpers.interopRequireDefault(n);b=f.default.Model.extend({namedAttributes:{anchor:null,attributes:null,
author:null,avatarSize:null,comments:null,tasks:null,createdDate:"number",html:"string",id:"number",isFocused:"boolean",isUnread:"boolean",parent:null,permittedOperations:null,properties:null,pullRequest:"object",text:"string",updatedDate:"number",version:"number"},validate:function(a){if(!a.text||!/\S/.test(a.text))return d.default.I18n.getText("bitbucket.web.comment.empty")},url:function(){var a={markup:!0};null!=this.get("avatarSize")&&(a.avatarSize=this.get("avatarSize"));null!=this.get("version")&&
(a.version=this.get("version"));var c=this.get("anchor");g.default.get(c,"commitRange.sinceRevision")&&(a.since=c.commitRange.sinceRevision.id);if(this.collection&&this.collection.urlBuilder)return c=this.collection.urlBuilder().withParams(a),this.isNew()||(c=c.addPathComponents(this.get("id"))),c.build();var b=q.default.parse(f.default.Model.prototype.url.apply(this,arguments));Object.keys(a).forEach(function(c){return b.addQueryParam(c,a[c])});return b.toString()},forEachCommentInThread:function(a){a(this);
g.default.forEach(this.get("comments"),function(c){c.forEachCommentInThread(a)})},sync:function(a,c,b){return p.default.sync(a,c,g.default.assign(b,{statusCode:{404:function(b,e,f,h,k){if((b=g.default.get(h,"errors.0"))&&b.message&&/comment/i.test(b.message)){if("create"===a&&null!=c.get("parent"))return{title:d.default.I18n.getText("bitbucket.web.comment.notfound"),message:d.default.I18n.getText("bitbucket.web.comment.reply.parent.notfound.message"),shouldReload:!0,fallbackUrl:void 0};if("update"===
a)return{title:d.default.I18n.getText("bitbucket.web.comment.notfound"),message:d.default.I18n.getText("bitbucket.web.comment.update.notfound.message"),shouldReload:!0,fallbackUrl:void 0}}}}}))}});f.default.Mixins.applyMixin(b,{namedAttributes:{comments:[b]}});e.default=b;h.exports=e["default"]});