define("bitbucket/internal/feature/repository/branch-selector-field-internals/branch-selector-field-internals","@atlassian/aui jquery lodash bitbucket/internal/feature/repository/revision-reference-selector/revision-reference-selector bitbucket/internal/model/revision-reference bitbucket/internal/util/events bitbucket/internal/widget/searchable-selector/searchable-selector".split(" "),function(q,r,t,u,v,w,x){function y(){for(var b=[],a=e.length;a--;)e[a].$input.closest(document.body).length?b.push(e[a]):
e[a].destroy();e=b}function z(b){if(!b||!k.default.isArray(b))return null;k.default.forEach(b,function(a){var b=l.default.type.from(a.type);null!=b&&(a.type=b)});return A.default.constructDataPageFromPreloadArray(b)}var p=babelHelpers.interopRequireDefault(q),m=babelHelpers.interopRequireDefault(r),k=babelHelpers.interopRequireDefault(t),B=babelHelpers.interopRequireDefault(u),l=babelHelpers.interopRequireDefault(v),n=babelHelpers.interopRequireDefault(w),A=babelHelpers.interopRequireDefault(x),e=
[];(0,m.default)(document).bind("hideLayer",function(){setTimeout(y,0)});n.default.on("bitbucket.internal.widget.branchselector.inputAdded",function(b,a){(0,m.default)(document).ready(function(){function g(){c=c.length?c:(0,m.default)("#"+b);c.length||console.log("Branch selector field (#"+b+") was not found and not initialised. See https://jira.atlassian.com/browse/STASH-3914");var h=c.nextAll(".remove-link"),d=z(a.preloadData),f=new B.default(c.prevAll(".branch-selector-field"),{context:b,field:c,
triggerPlaceholder:a.triggerPlaceholder,show:{tags:a.showTags},preloadData:d,extraClasses:a.extraClasses,paginationContext:"branch-selector-field"});a.revisionId&&((d=d&&k.default.find(d.values,{id:a.revisionId}))?f.setSelectedItem(new l.default({id:d.id,displayId:d.displayId,type:d.type,isDefault:!1})):f.setSelectedItem(l.default.hydrateRefFromId(a.revisionId)));h.click(function(b){b.preventDefault();f.clearSelection();h.addClass("hidden")});var g=function(a){this===f&&(c.val(a?a.getId():""),n.default.trigger("bitbucket.component.branchSelector.change",
null,{elementId:b,ref:a?a.toJSON():null}),a.getType().id===l.default.type.TAG.id?h.text(p.default.I18n.getText("bitbucket.web.branch.selector.remove.tag")):h.text(p.default.I18n.getText("bitbucket.web.branch.selector.remove.branch")),h.toggleClass("hidden",!a))};n.default.on("bitbucket.internal.feature.repository.revisionReferenceSelector.revisionRefChanged",g);e.push({$input:c,destroy:function(){n.default.off("bitbucket.internal.feature.repository.revisionReferenceSelector.revisionRefChanged",g);
f.destroy();f=null}})}var c=(0,m.default)("#"+b);c.length?g():k.default.defer(g)})})});