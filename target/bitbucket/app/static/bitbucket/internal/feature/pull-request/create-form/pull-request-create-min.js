define("bitbucket/internal/feature/pull-request/create-form/pull-request-create","module exports baconjs jquery lodash bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/feature/pull-request/metadata-generator/metadata-generator bitbucket/internal/feature/user/user-multi-selector/user-multi-selector bitbucket/internal/model/page-state bitbucket/internal/util/function bitbucket/internal/util/text bitbucket/internal/widget/markup-editor/markup-editor bitbucket/internal/widget/searchable-multi-selector/searchable-multi-selector".split(" "),
function(n,k,p,u,v,w,x,y,z,A,B,C,D,E){function F(a,f){a=a.filter(function(b){return b.source&&b.target});var c,e=function(b){b=m.default.filter(b.values,function(b){return 1===b.parents.length});b=m.default.map(b,q.default.dot("message"));G(b);c=null},d=(0,g.default)("#pull-request-description").asEventStream("keydown").doAction(function(b){(0,g.default)(b.target).data("description-changed",!0);c&&(c.abort(),c=null)}),h=H.default.combineAsArray(a,f).skipDuplicates(function(b,a){return b[0]===a[0]&&
b[1]===a[1]}).takeUntil(d).slidingWindow(2,1).map(function(b){if(1===b.length)return b[0].push(!1),b[0];b[1].push(b[0][1]!==b[1][1]);return b[1]}).onValue(function(b){var a=b[0];c&&c.abort();b=a.source;a=a.target;b=r.default.project(b.getRepository().getProject()).repo(b.getRepository()).commits().withParams({until:b.getLatestCommit(),since:a.getLatestCommit(),secondaryRepositoryId:a.getRepository().getId(),start:0,limit:10}).build();c=I.default.rest({type:"GET",url:b,statusCode:{"*":!1}}).done(e)});
return function(){h()}}function G(a){if(0!==a.length){var f=(0,g.default)("#title"),c=(0,g.default)("#pull-request-description"),e=!f.data("title-changed"),d=!c.data("description-changed");e&&1===a.length?(a=l.default.generateTitleAndDescriptionFromCommitMessage(a[0]),f.val(a.title),d&&c.val(a.description).trigger("input")):d&&(f=l.default.generateDescriptionFromCommitMessages(a),c.val(f).trigger("input"))}}function J(a){e.default.extend("targetRepository");e.default.extend("sourceRepository");e.default.extend("targetBranch");
e.default.extend("sourceBranch");return a.onValue(function(a){e.default.setTargetRepository(a.targetRepo);e.default.setSourceRepository(a.sourceRepo);e.default.setTargetBranch(a.target);e.default.setSourceBranch(a.source)})}Object.defineProperty(k,"__esModule",{value:!0});var H=babelHelpers.interopRequireDefault(p),g=babelHelpers.interopRequireDefault(u),m=babelHelpers.interopRequireDefault(v),r=babelHelpers.interopRequireDefault(w),I=babelHelpers.interopRequireDefault(x),l=babelHelpers.interopRequireDefault(y),
K=babelHelpers.interopRequireDefault(z),e=babelHelpers.interopRequireDefault(A),q=babelHelpers.interopRequireDefault(B),t=babelHelpers.interopRequireDefault(C),L=babelHelpers.interopRequireDefault(D),M=babelHelpers.interopRequireDefault(E);k.default={init:function(a,f,c,k,d){var h=[];a=(0,g.default)(a);L.default.bindTo(a.find(".markup-editor"));var b=e.default.getCurrentUser(),l={avatarSize:bitbucket.internal.widget.avatarSizeInPx({size:"xsmall"}),permission:"LICENSED_USER"},n=new M.default.PagedDataSource(r.default.rest().users().build(),
l);new K.default(a.find("#reviewers"),{initialItems:f,excludedItems:b?[b.toJSON()]:[],dataSource:n});f=c.onValue(function(a){g.default.extend(l,{"permission.1":"REPO_READ","permission.1.repositoryId":a.targetRepo.id})});h.push({destroy:f});var p=a.find("#submit-form");d=d.onValue(function(a){p.enable(a).attr("aria-disabled",!a)});h.push({destroy:d});d=a.find("#title");""===d.val()&&(a=d.asEventStream("keydown").doAction(function(a){(0,g.default)(a.target).data("title-changed",!0)}),d=c.map(m.default.flow(q.default.dotX("source.getDisplayId"),
t.default.convertBranchNameToSentence.bind(t.default))).takeUntil(a).onValue(d.val.bind(d)),h.push({destroy:d}));""===(0,g.default)("#pull-request-description").val()&&h.push({destroy:F(c,k)});h.push({destroy:J(c)});return{destroy:function(){m.default.invokeMap(h,"destroy")}}}};n.exports=k["default"]});