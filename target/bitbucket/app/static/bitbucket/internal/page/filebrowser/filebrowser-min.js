define("bitbucket/internal/page/filebrowser/filebrowser","module exports @atlassian/aui chaperone jquery lodash bitbucket/internal/feature/filebrowser/file-finder/file-finder bitbucket/internal/feature/filebrowser/file-table/file-table bitbucket/internal/model/content-tree-node-types bitbucket/internal/model/path bitbucket/internal/model/revision-reference bitbucket/internal/util/events".split(" "),function(B,l,f,C,D,E,F,g,G,H,I,J){function K(){return x.find(".file-row a").map(function(a,b){a=(0,
d.default)(b);b=a.parent().parent();return{name:a.text(),contentId:a.attr("data-contentId"),type:b.hasClass("file")?t.default.FILE:b.hasClass("directory")?t.default.DIRECTORY:t.default.SUBMODULE}}).toArray()}function L(){var h={focusedClass:"focused-file",wrapAround:!1,escToCancel:!1},b="#browse-table tr.file-row."+h.focusedClass;a.default.on("bitbucket.internal.keyboard.shortcuts.requestMoveToNextHandler",function(a){(this.moveToNextItem?this:c.default.whenIType(a)).moveToNextItem("#browse-table tr.file-row",
h)});a.default.on("bitbucket.internal.keyboard.shortcuts.requestMoveToPreviousHandler",function(a){(this.moveToPrevItem?this:c.default.whenIType(a)).moveToPrevItem("#browse-table tr.file-row",h)});a.default.on("bitbucket.internal.keyboard.shortcuts.requestOpenItemHandler",function(e){(this.execute?this:c.default.whenIType(e)).execute(function(){if(!q){var e=(0,d.default)(b);e.length&&(e.hasClass("file")?(a.default.trigger("bitbucket.internal.feature.filetable.showSpinner",this),window.location.href=
e.find("a").attr("href")):e.find("a").click())}})});a.default.on("bitbucket.internal.keyboard.shortcuts.requestOpenParentHandler",function(a){(this.execute?this:c.default.whenIType(a)).execute(function(){if(!q){var a=(0,d.default)(u.getParentDirSelector());a.length&&a.click()}})});a.default.on("bitbucket.internal.keyboard.shortcuts.requestOpenFileFinderHandler",function(b){y=c.default.I18n.getText("bitbucket.web.file.finder.findfiles.tooltip",b);m.attr("title",y).tooltip({gravity:"ne"});(this.execute?
this:c.default.whenIType(b)).execute(function(){a.default.trigger("bitbucket.internal.feature.filetable.showFind",this)})});a.default.on("bitbucket.internal.keyboard.shortcuts.requestCloseFileFinderHandler",function(b){z=c.default.I18n.getText("bitbucket.web.file.finder.browse.files.tooltip",b);n.attr("title",z).tooltip();(this.execute?this:c.default.whenIType(b)).execute(function(){a.default.trigger("bitbucket.internal.feature.filetable.hideFind",this)})})}Object.defineProperty(l,"__esModule",{value:!0});
var c=babelHelpers.interopRequireDefault(f),M=babelHelpers.interopRequireDefault(C),d=babelHelpers.interopRequireDefault(D),N=babelHelpers.interopRequireDefault(E);f=babelHelpers.interopRequireDefault(F);g=babelHelpers.interopRequireDefault(g);var t=babelHelpers.interopRequireDefault(G),v=babelHelpers.interopRequireDefault(H),A=babelHelpers.interopRequireDefault(I),a=babelHelpers.interopRequireDefault(J),O=g.default.FileTable,P=g.default.FileTableView,Q=f.default.FileFinder,q,r,u,p,y,z,w,x,m,n;l.default=
{onReady:function(h,b,e,g,l){var f=new v.default(h),k=new A.default(b);w=(0,d.default)(".find-files");x=(0,d.default)(".filebrowser-content");m=w.find(".find-files-button");n=w.find(".browse-files-button");u=new P(e);r=new O(f,k,l);p=new Q(g,k);(0,d.default)(document).on("focus","#browse-table tr.file-row",function(){(0,d.default)(".focused-file").removeClass("focused-file");(0,d.default)(this).addClass("focused-file")});a.default.on("bitbucket.internal.history.popstate",function(a){a.state&&(k=new A.default(a.state.revisionRef))});
b=function(b){k!==b&&(k=b,a.default.trigger("bitbucket.internal.page.filebrowser.revisionRefChanged",null,b))};a.default.on("bitbucket.internal.layout.branch.revisionRefChanged",b);a.default.on("bitbucket.internal.feature.filetable.revisionRefChanged",b);a.default.on("bitbucket.internal.widget.branchselector.dialogShown",function(){q=!0});a.default.on("bitbucket.internal.widget.branchselector.dialogHidden",function(){q=!1});b=function(b){a.default.trigger("bitbucket.internal.page.filebrowser.urlChanged",
null,b)};a.default.on("bitbucket.internal.layout.*.urlChanged",b);a.default.on("bitbucket.internal.feature.*.urlChanged",b);a.default.on("bitbucket.internal.feature.*.pathChanged",function(b){f=new v.default(b);a.default.trigger("bitbucket.internal.page.filebrowser.pathChanged",null,f.toJSON())});a.default.on("bitbucket.internal.widget.keyboard-shortcuts.register-contexts",function(a){a.enableContext("filebrowser")});b=function(){p.isLoaded()&&(m.attr("aria-pressed",!1),n.attr("aria-pressed",!0),
p.unloadFinder(),r.data?u.update(r.data):r.reload())};a.default.on("bitbucket.internal.feature.filetable.showFind",function(){p.isLoaded()||(m.attr("aria-pressed",!0),n.attr("aria-pressed",!1),p.loadFinder())});a.default.on("bitbucket.internal.feature.filetable.hideFind",b);a.default.on("bitbucket.internal.page.filebrowser.revisionRefChanged",b);a.default.trigger("bitbucket.internal.feature.filebrowser.filesChanged",null,{files:K(),path:(new v.default(h)).toJSON(),revision:k.getId()});a.default.on("bitbucket.internal.feature.filetable.dataReceived",
function(b){b&&b.children&&a.default.trigger("bitbucket.internal.feature.filebrowser.filesChanged",null,{files:b.children.values.map(function(a){return N.default.pick(a,"name","contentId","type")}),path:b.path,revision:b.revisionRef&&b.revisionRef.id})});m.click(function(){a.default.trigger("bitbucket.internal.feature.filetable.showFind");return!1});n.click(function(){a.default.trigger("bitbucket.internal.feature.filetable.hideFind");return!1});L();M.default.registerFeature("watch-repository",[{id:"watch-repository",
alignment:"top right",selector:".watch-repository-feature-discovery-trigger",title:c.default.I18n.getText("bitbucket.web.repository.watch.discovery.title"),content:bitbucket.internal.widget.paragraph({text:c.default.I18n.getText("bitbucket.web.repository.watch.discovery.desc")}),close:{text:c.default.I18n.getText("bitbucket.web.got.it")},width:350,once:!0}])}};B.exports=l["default"]});