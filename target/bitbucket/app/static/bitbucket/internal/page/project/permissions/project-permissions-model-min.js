define("bitbucket/internal/page/project/permissions/project-permissions-model","module exports backbone-brace lodash bitbucket/util/navbuilder bitbucket/internal/util/ajax".split(" "),function(h,c,d,k,l,m){Object.defineProperty(c,"__esModule",{value:!0});d=babelHelpers.interopRequireDefault(d);var n=babelHelpers.interopRequireDefault(k),f=babelHelpers.interopRequireDefault(l),g=babelHelpers.interopRequireDefault(m),b=d.default.Model.extend({namedAttributes:{grantedDefaultPermission:"string",publicAccess:"boolean"},
getEffectiveDefaultPermission:function(){return this.getPublicAccess()&&this.getGrantedDefaultPermission()===b.NONE?b.READ:this.getGrantedDefaultPermission()},savePublicAccess:function(a){var e=this.getPublicAccess();this.setPublicAccess(a);return b._sendSavePublicAccessRequest(a).fail(n.default.bind(function(){this.setPublicAccess(e)},this))},saveDefaultPermission:function(a){var e=b.unpackPermission(a),c=this,d=this.getGrantedDefaultPermission();this.setGrantedDefaultPermission(a);return b._sendSavePermissionRequest(f.default.rest().currentProject().permissions().projectRead().all(),
e.read).then(function(){return b._sendSavePermissionRequest(f.default.rest().currentProject().permissions().projectWrite().all(),e.write).fail(function(){var a=b.unpackPermission(d).write;e.write=a;c.setGrantedDefaultPermission(b.packPermission(e))})},function(){c.setGrantedDefaultPermission(d)})}},{WRITE:"write",READ:"read",NONE:"none",unpackPermission:function(a){return{read:a===b.WRITE||a===b.READ,write:a===b.WRITE}},packPermission:function(a){return a.write?b.WRITE:a.read?b.READ:b.NONE},_sendSavePermissionRequest:function(a,
b){return g.default.rest({type:"POST",url:a.allow(b).build()})},_sendSavePublicAccessRequest:function(a){return g.default.rest({type:"PUT",url:f.default.rest().currentProject().build(),data:{public:a}})}});c.default=b;h.exports=c["default"]});