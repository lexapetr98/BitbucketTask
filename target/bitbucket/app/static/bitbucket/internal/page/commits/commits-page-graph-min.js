define("bitbucket/internal/page/commits/commits-page-graph",["exports","lodash","react","bitbucket/util/events","bitbucket/internal/feature/commit-graph/commit-graph"],function(b,q,e,m,n){Object.defineProperty(b,"__esModule",{value:!0});b.CommitsPageGraph=void 0;var p=babelHelpers.interopRequireDefault(e),a=babelHelpers.interopRequireDefault(m),h=[],g=function(a){return JSON.parse(a.getAttribute("data-commit-json"))};b.CommitsPageGraph=function(b){function d(){var a,k,c,b;babelHelpers.classCallCheck(this,
d);for(var e=arguments.length,l=Array(e),f=0;f<e;f++)l[f]=arguments[f];return b=(k=(c=babelHelpers.possibleConstructorReturn(this,(a=d.__proto__||Object.getPrototypeOf(d)).call.apply(a,[this].concat(l))),c),c.state={},c.addCommits=function(a){var b=a.values;return setTimeout(function(){c.setState(function(a){return{commits:a.commits.concat(b.toArray().map(g))}})})},c.focusCommit=function(a){c.setState({focusedCommitId:g(a).id})},c.reset=function(){return c.setState({commits:h})},k),babelHelpers.possibleConstructorReturn(c,
b)}babelHelpers.inherits(d,b);babelHelpers.createClass(d,[{key:"componentDidMount",value:function(){a.default.on("bitbucket.internal.widget.commitsTable.contentAdded",this.addCommits);a.default.on("bitbucket.internal.widget.commitsTable.rowFocused",this.focusCommit);a.default.on("bitbucket.internal.history.changestate",this.reset);a.default.on("bitbucket.internal.layout.branch.revisionRefChanged",this.reset)}},{key:"componentWillUnmount",value:function(){a.default.off("bitbucket.internal.widget.commitsTable.contentAdded",
this.addCommits);a.default.off("bitbucket.internal.widget.commitsTable.rowFocused",this.focusCommit);a.default.off("bitbucket.internal.history.changestate",this.reset);a.default.off("bitbucket.internal.layout.branch.revisionRefChanged",this.reset)}},{key:"render",value:function(){var a=this.state,b=this.props,c=b.rowHeight;return p.default.createElement(n.CommitGraph,{commits:a.commits,focusedCommitId:a.focusedCommitId,offsetY:Math.round(c/2)+b.headerRowHeight,sliceHeight:c})}}],[{key:"getDerivedStateFromProps",
value:function(a,b){a=a.initialRows;return b.commits?null:{commits:a?a.map(g):h}}}]);return d}(e.PureComponent)});