(function(u){function q(e,g){return(Math.abs(e.r-g.r)+Math.abs(e.g-g.g)+Math.abs(e.b-g.b))/3}var y=1,f={red:255,green:0,blue:255,alpha:255},r={flat:function(e,g){return{r:f.red,g:f.green,b:f.blue,a:f.alpha}},movement:function(e,g){return{r:(f.red/255*g.r+f.red)/2,g:(f.green/255*g.g+f.green)/2,b:(f.blue/255*g.b+f.blue)/2,a:g.a}},flatDifferenceIntensity:function(e,g){return{r:f.red,g:f.green,b:f.blue,a:q(e,g)}},movementDifferenceIntensity:function(e,g){e=q(e,g)/255*.8;return{r:f.red/255*(1-e)*g.r+e*
f.red,g:f.green/255*(1-e)*g.g+e*f.green,b:f.blue/255*(1-e)*g.b+e*f.blue,a:g.a}}},E=r.flat,z=1200,K=/^https?:\/\//,L=new RegExp("^https?://"+document.domain);u.resemble=function(e){function g(){var a=v.length,d;for(d=0;d<a;d++)if("function"===typeof v[d])v[d](m)}function f(a,d,b){var c,n;for(c=0;c<a;c++)for(n=0;n<d;n++)b(c,n)}function r(a,d,b){var c=0,n=0,e=0,k=0,F=0;f(b,d,function(b,g){var f=4*(b*d+g);b=a[f];g=a[f+1];f=a[f+2];c++;n+=b/255*100;e+=g/255*100;k+=f/255*100;F+=(.3*b+.59*g+.11*f)/255*100});
m.red=Math.floor(n/c);m.green=Math.floor(e/c);m.blue=Math.floor(k/c);m.brightness=Math.floor(F/c);g()}function B(a,d){var b=new Image;K.test(a)&&!L.test(a)&&b.setAttribute("crossorigin","anonymous");b.onload=function(){var a=document.createElement("canvas"),c=b.width,e=b.height;a.width=c;a.height=e;a.getContext("2d").drawImage(b,0,0,c,e);a=a.getContext("2d").getImageData(0,0,c,e);k.push(a);d(a,c,e)};if("string"===typeof a){if(b.src=a,b.complete)b.onload()}else if("undefined"!==typeof a.data&&"number"===
typeof a.width&&"number"===typeof a.height)k.push(a),d(a,a.width,a.height);else{var c=new FileReader;c.onload=function(a){b.src=a.target.result};c.readAsDataURL(a)}}function t(a,d,b){var c=Math.abs(a-d);return"undefined"===typeof a||"undefined"===typeof d?!1:a===d?!0:c<h[b]?!0:!1}function u(a,d){var b=t(a.a,d.a,"alpha");return t(a.brightness,d.brightness,"minBrightness")&&b}function q(a,d,b){a/=255;d/=255;b/=255;var c=Math.max(a,d,b),e=Math.min(a,d,b);if(c==e)var g=0;else{e=c-e;switch(c){case a:g=
(d-b)/e+(d<b?6:0);break;case d:g=(b-a)/e+2;break;case b:g=(a-d)/e+4}g/=6}return g}function G(a,d,b,c,e,g){var f,n,k=0,p=0,m=0;a.h=q(a.r,a.g,a.b);for(f=-1;1>=f;f++)for(n=-1;1>=n;n++)if(0!==f||0!==n){var l=4*((c+n)*g+(e+f));l=C(d,l,b);if(null!==l){w(l);l.h=q(l.r,l.g,l.b);Math.abs(a.brightness-l.brightness)>h.maxBrightness&&k++;var M=a.g===l.g,N=a.b===l.b;a.r===l.r&&M&&N&&m++;.3<Math.abs(l.h-a.h)&&p++;if(1<p||1<k)return!0}}return 2>m?!0:!1}function D(a,d,b,c){b=E(b,c);a[d]=b.r;a[d+1]=b.g;a[d+2]=b.b;
a[d+3]=b.a}function H(a,d,b){a[d]=b.brightness;a[d+1]=b.brightness;a[d+2]=b.brightness;a[d+3]=b.a*y}function C(a,d,b){b=a[d];if("undefined"!==typeof b){var c=a[d+1];var e=a[d+2];a=a[d+3];return a={r:b,g:c,b:e,a:a}}return null}function w(a){a.brightness=.3*a.r+.59*a.g+.11*a.b}function O(a,d,b,c){var e=document.createElement("canvas"),g=a.data,k=d.data;e.width=b;e.height=c;var h=e.getContext("2d"),q=h.createImageData(b,c),p=q.data,r=0;a=Date.now();var l;z&&x&&(b>z||c>z)&&(l=6);f(c,b,function(a,e){if(!l||
0!==a%l&&0!==e%l){var d=4*(a*b+e),c=C(g,d,1),f=C(k,d,2);if(null!==c&&null!==f)if(A)w(c),w(f),u(c,f)?H(p,d,f):(D(p,d,c,f),r++);else{var h=t(c.r,f.r,"red"),n=t(c.g,f.g,"green"),m=t(c.b,f.b,"blue"),q=t(c.a,f.a,"alpha");h&&n&&m&&q?(p[d]=c.r,p[d+1]=c.g,p[d+2]=c.b,p[d+3]=c.a*y):x&&(w(c),w(f),G(c,g,1,a,e,b)||G(f,k,2,a,e,b))?u(c,f)?H(p,d,f):(D(p,d,c,f),r++):(D(p,d,c,f),r++)}}});m.misMatchPercentage=(r/(c*b)*100).toFixed(2);m.analysisTime=Date.now()-a;m.getImageDataUrl=function(a){var c=0;a&&(h.font="12px sans-serif",
c=h.measureText(a).width+4,c>e.width&&(e.width=c),e.height+=22,h.fillStyle="#666",h.fillRect(0,0,e.width,18),h.fillStyle="#fff",h.fillRect(0,18,e.width,4),h.fillStyle="#fff",h.textBaseline="top",h.font="12px sans-serif",h.fillText(a,2,1),c=22);h.putImageData(q,0,c);return e.toDataURL("image/png")}}function I(a,d,b){if(a.height<b||a.width<d){var c=document.createElement("canvas");c.width=d;c.height=b;c=c.getContext("2d");c.putImageData(a,0,0);return c.getImageData(0,0,d,b)}return a}function P(a,d){function b(){if(2===
k.length){var a=k[0].width>k[1].width?k[0].width:k[1].width;var b=k[0].height>k[1].height?k[0].height:k[1].height;m.isSameDimensions=k[0].width===k[1].width&&k[0].height===k[1].height?!0:!1;m.dimensionDifference={width:k[0].width-k[1].width,height:k[0].height-k[1].height};O(I(k[0],a,b),I(k[1],a,b),a,b);g()}}k=[];B(a,b);B(d,b)}function J(a){var d,b="function"===typeof a;b||(d=a);var c={ignoreNothing:function(){h.red=16;h.green=16;h.blue=16;h.alpha=16;h.minBrightness=16;h.maxBrightness=240;A=x=!1;b&&
a();return c},ignoreAntialiasing:function(){h.red=32;h.green=32;h.blue=32;h.alpha=32;h.minBrightness=64;h.maxBrightness=96;x=!0;A=!1;b&&a();return c},ignoreColors:function(){h.alpha=16;h.minBrightness=16;h.maxBrightness=240;x=!1;A=!0;b&&a();return c},repaint:function(){b&&a();return c},onComplete:function(a){v.push(a);a=function(){P(e,d)};a();return J(a)}};return c}var m={},k=[],v=[],h={red:16,green:16,blue:16,alpha:16,minBrightness:16,maxBrightness:240},x=!1,A=!1;return{onComplete:function(a){v.push(a);
B(e,function(a,b,c){r(a.data,b,c)})},compareTo:function(a){return J(a)}}};u.resemble.outputSettings=function(e){var g;if(e.errorColor)for(g in e.errorColor)f[g]=void 0===e.errorColor[g]?f[g]:e.errorColor[g];e.errorType&&r[e.errorType]&&(E=r[e.errorType]);y=isNaN(Number(e.transparency))?y:e.transparency;void 0!==e.largeImageThreshold&&(z=e.largeImageThreshold);return this}})(this);