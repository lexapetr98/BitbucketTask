/*
 jsUri
 https://github.com/derek-watson/jsUri

 Copyright 2013, Derek Watson
 Released under the MIT license.

 Includes parseUri regular expressions
 http://blog.stevenlevithan.com/archives/parseuri
 Copyright 2007, Steven Levithan
 Released under the MIT license.
*/
(function(n){function h(a){a&&(a=a.toString().replace(g.pluses,"%20"),a=decodeURIComponent(a));return a}function p(a){var b=g.uri_parser.exec(a||""),e={};"source protocol authority userInfo user password host port isColonUri relative path directory file query anchor".split(" ").forEach(function(a,k){e[a]=b[k]||""});return e}function m(a){var b,e=[];if("undefined"===typeof a||null===a||""===a)return e;0===a.indexOf("?")&&(a=a.substring(1));var d=a.toString().split(g.query_separator);a=0;for(b=d.length;a<
b;a++){var k=d[a];var f=k.indexOf("\x3d");if(0!==f){var c=h(k.substring(0,f));var l=h(k.substring(f+1));e.push(-1===f?[k,null]:[c,l])}}return e}function c(a){this.uriParts=p(a);this.queryPairs=m(this.uriParts.query);this.hasAuthorityPrefixUserPref=null}var g={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var e,d;if(null==this)throw new TypeError(" this is null or not defined");var c=Object(this),f=c.length>>>0;if("function"!==typeof a)throw new TypeError(a+" is not a function");1<arguments.length&&(e=b);for(d=0;d<f;){if(d in c){var h=c[d];a.call(e,h,d,c)}d++}});"protocol userInfo host port path anchor".split(" ").forEach(function(a){c.prototype[a]=function(b){"undefined"!==typeof b&&(this.uriParts[a]=b);return this.uriParts[a]}});c.prototype.hasAuthorityPrefix=
function(a){"undefined"!==typeof a&&(this.hasAuthorityPrefixUserPref=a);return null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref};c.prototype.isColonUri=function(a){if("undefined"!==typeof a)this.uriParts.isColonUri=!!a;else return!!this.uriParts.isColonUri};c.prototype.query=function(a){var b="",e;"undefined"!==typeof a&&(this.queryPairs=m(a));a=0;for(e=this.queryPairs.length;a<e;a++){var d=this.queryPairs[a];0<b.length&&(b+="\x26");null===
d[1]?b+=d[0]:(b+=d[0],b+="\x3d","undefined"!==typeof d[1]&&(b+=encodeURIComponent(d[1])))}return 0<b.length?"?"+b:b};c.prototype.getQueryParamValue=function(a){var b;var e=0;for(b=this.queryPairs.length;e<b;e++){var d=this.queryPairs[e];if(a===d[0])return d[1]}};c.prototype.getQueryParamValues=function(a){var b=[],e;var d=0;for(e=this.queryPairs.length;d<e;d++){var c=this.queryPairs[d];a===c[0]&&b.push(c[1])}return b};c.prototype.deleteQueryParam=function(a,b){var e=[],d;var c=0;for(d=this.queryPairs.length;c<
d;c++){var f=this.queryPairs[c];var g=h(f[0])===h(a);var l=f[1]===b;(1!==arguments.length||g)&&(2!==arguments.length||g&&l)||e.push(f)}this.queryPairs=e;return this};c.prototype.addQueryParam=function(a,b,c){3===arguments.length&&-1!==c?(c=Math.min(c,this.queryPairs.length),this.queryPairs.splice(c,0,[a,b])):0<arguments.length&&this.queryPairs.push([a,b]);return this};c.prototype.hasQueryParam=function(a){var b,c=this.queryPairs.length;for(b=0;b<c;b++)if(this.queryPairs[b][0]==a)return!0;return!1};
c.prototype.replaceQueryParam=function(a,b,c){var d=-1,e=this.queryPairs.length,f;if(3===arguments.length){for(f=0;f<e;f++){var g=this.queryPairs[f];if(h(g[0])===h(a)&&decodeURIComponent(g[1])===h(c)){d=f;break}}0<=d&&this.deleteQueryParam(a,h(c)).addQueryParam(a,b,d)}else{for(f=0;f<e;f++)if(g=this.queryPairs[f],h(g[0])===h(a)){d=f;break}this.deleteQueryParam(a);this.addQueryParam(a,b,d)}return this};"protocol hasAuthorityPrefix isColonUri userInfo host port path query anchor".split(" ").forEach(function(a){var b=
"set"+a.charAt(0).toUpperCase()+a.slice(1);c.prototype[b]=function(b){this[a](b);return this}});c.prototype.scheme=function(){var a="";this.protocol()?(a+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(a+=":"),a+="//"):this.hasAuthorityPrefix()&&this.host()&&(a+="//");return a};c.prototype.origin=function(){var a=this.scheme();this.userInfo()&&this.host()&&(a+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(a+="@"));this.host()&&(a+=this.host(),
this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(a+=":"+this.port());return a};c.prototype.addTrailingSlash=function(){var a=this.path()||"";"/"!==a.substr(-1)&&this.path(a+"/");return this};c.prototype.toString=function(){var a=this.origin();if(this.isColonUri())this.path()&&(a+=":"+this.path());else if(this.path()){var b=this.path();g.ends_with_slashes.test(a)||g.starts_with_slashes.test(b)?(a&&a.replace(g.ends_with_slashes,"/"),b=b.replace(g.starts_with_slashes,"/")):a+="/";
a+=b}else this.host()&&(this.query().toString()||this.anchor())&&(a+="/");this.query().toString()&&(a+=this.query().toString());this.anchor()&&(0!==this.anchor().indexOf("#")&&(a+="#"),a+=this.anchor());return a};c.prototype.clone=function(){return new c(this.toString())};"function"===typeof define&&define.amd?define(function(){return c}):"undefined"!==typeof module&&"undefined"!==typeof module.exports?module.exports=c:n.Uri=c})(this);